(()=>{var a={};a.id=5413,a.ids=[5413],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},1165:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>X,patchFetch:()=>W,routeModule:()=>S,serverHooks:()=>V,workAsyncStorage:()=>T,workUnitAsyncStorage:()=>U});var d={};c.r(d),c.d(d,{POST:()=>H,runtime:()=>C});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(10641),v=c(77598),w=c(12831),x=c(7633),y=c(76522);let z=["stl","step","stp","iges","igs","sldprt","sldasm","pdf","zip"],A=new Set(z);z.map(a=>`.${a}`).join(",");let B=a=>Number((a/1048576).toFixed(1)),C="nodejs",D=process.env.SUPABASE_CAD_BUCKET||process.env.NEXT_PUBLIC_CAD_BUCKET||process.env.NEXT_PUBLIC_SUPABASE_STORAGE_BUCKET||"cad",E={stl:"model/stl",step:"application/step",stp:"application/step",iges:"model/iges",igs:"model/iges",sldprt:"application/sldprt",sldasm:"application/sldasm",zip:"application/zip",pdf:"application/pdf"},F=`${B(0x1900000)} MB`;function G(a,b=400,c={}){let{step:d,...e}=c;return u.NextResponse.json({success:!1,message:a,step:d??"error",...e},{status:b})}async function H(a){let b={};try{var c,d;let e=await (0,y.JR)(),f=function(a){if(!a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}(e.email??null);if(!f)return console.error("[quote] session missing email",{userId:e.id}),G("Your session is missing a verified email. Refresh or sign in again.",400,{step:"auth"});b.userId=e.id,b.sessionEmail=f;let g=await a.formData(),h=g.get("file");if(!(h instanceof File))return N("Rejecting request: missing file in form-data payload"),G("Missing file in request.",400,{step:"validate-form"});b.fileName=h.name,b.fileSize=h.size,b.fileSizeLabel=K(h.size),b.providedType=h.type||"";let i=I(g.get("name")),j=I(g.get("company")),k=I(g.get("notes")),l=I(g.get("first_name")),m=I(g.get("last_name")),n=I(g.get("phone")),o=I(g.get("manufacturing_process")),p=I(g.get("quantity")),q=I(g.get("shipping_postal_code")),r=I(g.get("export_restriction")),s=I(g.get("rfq_reason")),t=J(g.get("itar_acknowledged")),B=J(g.get("terms_accepted")),C=i||[l,m].filter(Boolean).join(" ").trim(),H=L(h.name),P="stl"===H;if(b.extension=H,b.isStlUpload=P,N("Received upload request",{...b,bucket:D}),!C)return N("Rejecting upload: missing contact info",{...b,namePresent:!!C,sessionEmailPresent:!!f}),G("Name is required to submit a quote request.",400,{step:"validate-contact",missingFields:{name:!C,email:!1}});if(!(a=>{let b=a.toLowerCase().split("."),c=b.length>1?b.pop():"";return A.has(c)})(h.name))return N("Rejecting upload: unsupported extension",{...b,allowedExtensions:z.join(", ")}),G(`Unsupported file type ".${H||"unknown"}". Accepted formats: STEP, IGES, STL, SolidWorks (SLDPRT / SLDASM), PDF, or zipped assemblies.`,400,{step:"validate-extension",allowedExtensions:z,attemptedExtension:H||null});if(h.size>0x1900000)return N("Rejecting upload: exceeds size limit",{...b,maxBytes:0x1900000}),G(`File is ${K(h.size)}. Maximum allowed size is ${F}.`,413,{step:"validate-size",maxBytes:0x1900000,fileBytes:h.size});let S=Buffer.from(await h.arrayBuffer());if(0===S.byteLength)return N("Rejecting upload: empty file buffer",b),G("The uploaded file is empty.",400,{step:"validate-buffer"});let T=(c=h,d=H,c.type&&c.type.trim().length>0?c.type:E[d||L(c.name)]||"application/octet-stream");b.mimeType=T;let U=function(a,b){let c="cad-file",d="string"==typeof b&&b.length>0?b:"stl";if("string"!=typeof a||0===a.trim().length)return`${c}.${d}`;let e=a.trim().normalize("NFKD").replace(/[^\w.-]+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").toLowerCase();return e?e.includes(".")?e:`${e}.${d}`:`${c}.${d}`}(h.name,H),V=function(a){let b=Date.now(),c=(0,v.randomBytes)(6).toString("hex");return`uploads/${b}-${c}-${a}`}(U),W=`${D}/${V}`,X=w.w9;b.bucket=D,b.storageKey=V,b.storagePath=W,P&&N("Handling STL upload",{...b}),N("Uploading file to Supabase storage",b);let{error:Y}=await X.storage.from(D).upload(V,S,{cacheControl:"3600",contentType:T,upsert:!1});if(Y){let a=Y.statusCode;return O("Storage upload failed",{...b,error:{message:Y.message,name:Y.name,statusCode:a}}),G(`Storage upload failed: ${Y.message||"unknown error"}`,500,{step:"storage-upload",storageStatusCode:a})}let Z=null,$={name:C,email:f,company:j||null,user_id:e.id},{data:_,error:aa}=await X.from("customers").upsert($,{onConflict:"email"}).select("id").single();if(aa){let a=R(aa),c=Q(aa);(c?N:O)(c?"Customer upsert skipped (table missing)":"Customer upsert failed",{...b,error:a,missingTable:c})}else _?.id&&(Z=_.id);N("Inserting upload metadata row",{...b,customerId:Z});let{data:ab,error:ac}=await X.from("uploads").insert({file_name:h.name,file_path:W,mime_type:T,name:C,email:f,company:j||null,notes:k||null,customer_id:Z,status:x.Zo,first_name:l||null,last_name:m||null,phone:n||null,manufacturing_process:o||null,quantity:p||null,shipping_postal_code:q||null,export_restriction:r||null,rfq_reason:s||null,itar_acknowledged:t,terms_accepted:B}).select("id, file_name, file_path, mime_type, customer_id, quote_id").single();if(ac||!ab)return O("Upload metadata insert failed",{...b,error:R(ac)}),G(`Database insert failed: ${R(ac)||"unknown reason"}`,500,{step:"db-insert-upload"});let ad="quote_id"in ab?ab.quote_id??null:null;if(ad)b.quoteId=ad;else{let a=C||function(a){let b=a.user_metadata??{},c=M(b,"company");if(c)return c;let d=M(b,"full_name");if(d)return d;let e="string"==typeof a.email?a.email.trim():"";return e.length>0?e:null}(e)||f,c={upload_id:ab.id,customer_name:a,customer_email:f,company:j||null,file_name:h.name,status:x.Zo};console.log("[quote] create requested",{userId:e.id,email:f,payloadSummary:{fileCount:1,targetDate:null,process:o||null,material:null}});let{data:d,error:g}=await X.from("quotes").insert(c).select("id").single(),i=R(g);console.log("[quote] create result",{userId:e.id,email:f,quoteId:d?.id??null,uploadId:ab.id,error:i});let k=Q(g);if(g||!d)if(!k)return G("We couldn’t create your quote record. Please retry.",500,{step:"db-insert-quote"});else N("Quote insert skipped (table missing)",{...b,uploadId:ab.id,error:i});else{b.quoteId=ad=d.id;let{error:a}=await X.from("uploads").update({quote_id:ad,status:x.Zo}).eq("id",ab.id);a&&O("Upload quote link failed",{...b,error:R(a)})}}let ae={bucket:D,storageKey:V,storagePath:W,sizeBytes:h.size,mimeType:T,originalFileName:h.name,sanitizedFileName:U,extension:H||null},af=!1;try{let{error:a}=await X.from("files").insert({filename:h.name,size_bytes:h.size,mime:T,storage_path:W,bucket_id:D,quote_id:ad});if(a){let c=Q(a);(c?N:O)(c?"File metadata insert skipped (table missing)":"File metadata insert failed",{...b,error:R(a),missingTable:c})}else af=!0}catch(c){let a=Q(c);(a?N:O)(a?"File metadata insert skipped (table missing)":"Unexpected metadata insert error",{...b,error:R(c),missingTable:a})}return N("Upload finished successfully",{...b,uploadId:ab.id,customerId:ab.customer_id,quoteId:ad,metadataRecorded:af}),function(a,b={}){let{step:c,...d}=b;return u.NextResponse.json({success:!0,message:a,step:c??"complete",...d},{status:200})}("Upload complete. We’ll review your CAD shortly.",{uploadId:ab.id,quoteId:ad,file:ae,metadataRecorded:af})}catch(d){if(d instanceof y.D_)return G("Sign in to upload CAD files and sync them with your workspace.",401,{step:"auth"});let a=d instanceof Error?d.message:"string"==typeof d?d:null,c=d instanceof Error?d.stack:void 0;return O("unexpected upload handler error",{...b,errorMessage:a??"Unknown error",stack:c}),G("Unexpected server error while uploading your CAD. Please retry or contact support.",500,{step:"unexpected-error"})}}function I(a){return"string"==typeof a?a.trim():""}function J(a){if("string"!=typeof a)return!1;let b=a.trim().toLowerCase();return!!b&&("true"===b||"1"===b||"yes"===b||"on"===b)}function K(a){return!Number.isFinite(a)||a<=0?"0 MB":`${B(a)} MB`}function L(a){if("string"!=typeof a)return"";let b=a.toLowerCase().split(".");return b.length>1?b.pop()??"":""}function M(a,b){if(!a)return null;let c=a[b];if("string"!=typeof c)return null;let d=c.trim();return d.length>0?d:null}function N(a,b){if(b)return void console.log("[upload-debug]",a,P(b));console.log("[upload-debug]",a)}function O(a,b){if(b)return void console.error("[upload-error]",a,P(b));console.error("[upload-error]",a)}function P(a){let b={};return Object.entries(a).forEach(([a,c])=>{void 0!==c&&(b[a]=c)}),b}function Q(a){return!!a&&"object"==typeof a&&"PGRST205"===("code"in a&&"string"==typeof a.code?a.code:null)}function R(a){if(!a)return null;if("string"==typeof a)return a;if("object"==typeof a&&"message"in a&&"string"==typeof a.message){let b="string"==typeof a.code?a.code:null,c=a.message;return b?`${b}: ${c}`:c}try{return JSON.stringify(a)}catch{return String(a)}}let S=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/workspace/src/app/api/upload/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:T,workUnitAsyncStorage:U,serverHooks:V}=S;function W(){return(0,g.patchFetch)({workAsyncStorage:T,workUnitAsyncStorage:U})}async function X(a,b,c){var d;let e="/api/upload/route";"/index"===e&&(e="/");let g=await S.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=g,D=(0,j.normalizeAppPath)(e),E=!!(y.dynamicRoutes[D]||y.routes[C]);if(E&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[D];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let F=null;!E||S.isDev||x||(F="/index"===(F=C)?"/":F);let G=!0===S.isDev||!E,H=E&&!G,I=a.method||"GET",J=(0,i.getTracer)(),K=J.getActiveScopeSpan(),L={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:G,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:H,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>S.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},M=new k.NodeNextRequest(a),N=new k.NodeNextResponse(b),O=l.NextRequestAdapter.fromNodeNextRequest(M,(0,l.signalFromNodeResponse)(b));try{let d=async c=>S.handle(O,L).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=J.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${I} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${I} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&B&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=L.renderOpts.fetchMetrics;let i=L.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=L.renderOpts.collectedTags;if(!E)return await (0,o.I)(M,N,e,L.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,d=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await S.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:H,isOnDemandRevalidate:A})},z),b}},l=await S.handleResponse({req:a,nextConfig:w,cacheKey:F,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!E)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&E||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(M,N,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};K?await g(K):await J.withPropagatedContext(a.headers,()=>J.trace(m.BaseServerSpan.handleRequest,{spanName:`${I} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":I,"http.target":a.url}},g))}catch(b){if(K||b instanceof s.NoFallbackError||await S.onRequestError(a,b,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:H,isOnDemandRevalidate:A})}),E)throw b;return await (0,o.I)(M,N,new Response(null,{status:500})),null}}},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7633:(a,b,c)=>{"use strict";c.d(b,{$p:()=>i,LA:()=>j,Zo:()=>f,mh:()=>k,mj:()=>g,nu:()=>h});let d=["submitted","in_review","quoted","approved","rejected"],e={new:"submitted",on_hold:"in_review",closed_lost:"rejected",draft:"submitted"},f="submitted";function g(a){return"string"==typeof a&&d.includes(a)}function h(a,b=f){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(e[b])return e[b]}return b}function i(a){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(g(b))return b}return null}let j={submitted:"Submitted",in_review:"In review",quoted:"Quoted",approved:"Approved",rejected:"Rejected"},k=[...d]},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12831:(a,b,c)=>{"use strict";c.d(b,{E2:()=>i,qr:()=>h,w9:()=>j});var d=c(36464);let e=process.env.SUPABASE_URL??"https://qslztdkptpklopyedkfd.supabase.co/",f="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFzbHp0ZGtwdHBrbG9weWVka2ZkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MTYzMzksImV4cCI6MjA3ODk5MjMzOX0.et6RdF18ioinJKYNNTE0UVA5HvRH1YaXmA2DgRHLPWo",g=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e)throw Error("SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL is required (check your env vars).");let h=()=>{if(!f)throw Error("NEXT_PUBLIC_SUPABASE_ANON_KEY is required");return(0,d.UU)(e,f,{auth:{persistSession:!1}})},i=()=>{if(!g)throw Error("SUPABASE_SERVICE_ROLE_KEY is required");return(0,d.UU)(e,g,{auth:{persistSession:!1}})},j=i()},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30787:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return i}});let d=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=e(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(c(74515));function e(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(e=function(a){return a?c:b})(a)}let f={current:null},g="function"==typeof d.cache?d.cache:a=>a,h=console.warn;function i(a){return function(...b){h(a(...b))}}g(a=>{try{h(f.current)}finally{f.current=null}})},31023:(a,b,c)=>{"use strict";c.d(b,{Eh:()=>l,GG:()=>m,H:()=>p,On:()=>n,R0:()=>h,Ro:()=>f,gA:()=>i,gF:()=>k,gQ:()=>j,pU:()=>g,uW:()=>r});let d={quotes:"[admin quotes]",uploads:"[admin uploads]",dashboard:"[admin dashboard]"};function e(a,b,c,e){let f=d[a],g=function(a){if(!a)return null;let b=Object.entries(a).filter(([,a])=>void 0!==a);return 0===b.length?null:Object.fromEntries(b)}(e),h=[`${f} ${c}`,...g&&Object.keys(g).length>0?[g]:[]];return"error"===b?void console.error(...h):"warn"===b?void console.warn(...h):void console.log(...h)}function f(a,b){e("quotes","info",a,b)}function g(a,b){e("quotes","warn",a,b)}function h(a,b){e("quotes","error",a,b)}function i(a,b){e("uploads","info",a,b)}function j(a,b){e("uploads","warn",a,b)}function k(a,b){e("uploads","error",a,b)}function l(a,b){e("dashboard","info",a,b)}function m(a,b){e("dashboard","warn",a,b)}function n(a,b){e("dashboard","error",a,b)}function o(a){return a&&"object"==typeof a&&"supabaseError"in a&&a.supabaseError?a.supabaseError:a}function p(a){let b=o(a);return b&&"object"==typeof b?{code:"string"==typeof b.code?b.code:null,message:"string"==typeof b.message?b.message:null,details:"string"==typeof b.details?b.details:null,hint:"string"==typeof b.hint?b.hint:null}:b??null}let q=new Set(["PGRST205","42703"]);function r(a){let b=o(a);if(!b||"object"!=typeof b)return!1;let c="code"in b&&"string"==typeof b.code?b.code:null;return!!c&&q.has(c)}},43740:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isPostpone",{enumerable:!0,get:function(){return d}});let c=Symbol.for("react.postpone");function d(a){return"object"==typeof a&&null!==a&&a.$$typeof===c}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61981:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=c(98541),e=c(92781);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},76522:(a,b,c)=>{"use strict";c.d(b,{D_:()=>o,Dh:()=>n,JR:()=>p,MB:()=>j,Ss:()=>q});var d=c(86802),e=c(82161),f=c(4410),g=c(31023);let h="https://qslztdkptpklopyedkfd.supabase.co/",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFzbHp0ZGtwdHBrbG9weWVka2ZkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MTYzMzksImV4cCI6MjA3ODk5MjMzOX0.et6RdF18ioinJKYNNTE0UVA5HvRH1YaXmA2DgRHLPWo";if(!h||!i)throw Error("NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY must be set to enable auth.");function j(){let a=async()=>await (0,d.UL)();return(0,f.createServerClient)(h,i,{cookies:{async get(b){let c=await a();return c.get(b)?.value},async set(b,c,d){(await a()).set({name:b,value:c,...d})},async remove(b,c){(await a()).set({name:b,value:"",...c,maxAge:0})}}})}async function k(){let a=await (0,d.UL)();return(0,f.createServerClient)(h,i,{cookies:{get:b=>a.get(b)?.value,set(){},remove(){}}})}let l="DYNAMIC_SERVER_USAGE";function m(a){if(!a)return!1;let b=a=>{if(!a)return!1;if("string"==typeof a)return a.startsWith(l);if("object"==typeof a){let c=a.digest;if("string"==typeof c&&c.startsWith(l))return!0;let d=a.cause;if(d&&b(d))return!0}return!1};return b(a)||a instanceof Error&&b(a.message)}async function n(){try{let a=await (0,d.UL)(),b="function"==typeof a.getAll?a.getAll().map(a=>a.name):[];console.log("[auth] cookies seen by server:",b);let c=await k(),{data:e,error:f}=await c.auth.getUser(),h=f?(0,g.H)(f):null;if(console.info("[auth] getUser result:",{hasUser:!!e?.user,email:e?.user?.email??null,error:h}),f){if(m(f))return console.info("[auth] getUser run skipped during static generation (dynamic route only)"),{user:null,error:h??f};return console.error("[auth] getUser failed",f),{user:null,error:h??f}}if(!e?.user)return console.warn("[auth] no authenticated user returned by Supabase"),{user:null,error:null};return{user:e.user,error:null}}catch(a){if(m(a))return console.info("[auth] getServerAuthUser skipped during static generation (dynamic route only)"),{user:null,error:a};return console.error("[auth] getServerAuthUser: unexpected failure",a),{user:null,error:a}}}class o extends Error{constructor(a="Authentication required"){super(a),this.name="UnauthorizedError"}}async function p(a){let{user:b,error:c}=await n();if(b)return b;throw console.error("[auth] requireUser failed",{reason:"no-user",error:c}),a?.redirectTo&&(0,e.redirect)(a.redirectTo),new o(a?.message??"You must be signed in.")}async function q(a){return p(a)}},77598:a=>{"use strict";a.exports=require("node:crypto")},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},92781:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{REDIRECT_ERROR_CODE:function(){return e},RedirectType:function(){return f},isRedirectError:function(){return g}});let d=c(91203),e="NEXT_REDIRECT";var f=function(a){return a.push="push",a.replace="replace",a}({});function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,f]=b,g=b.slice(2,-2).join(";"),h=Number(b.at(-2));return c===e&&("replace"===f||"push"===f)&&"string"==typeof g&&!isNaN(h)&&h in d.RedirectStatusCode}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},96487:()=>{},98541:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{HTTPAccessErrorStatus:function(){return c},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return e},getAccessFallbackErrorTypeByStatus:function(){return h},getAccessFallbackHTTPStatus:function(){return g},isHTTPAccessFallbackError:function(){return f}});let c={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},d=new Set(Object.values(c)),e="NEXT_HTTP_ERROR_FALLBACK";function f(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===e&&d.has(Number(c))}function g(a){return Number(a.digest.split(";")[1])}function h(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4586,6464,75,1692],()=>b(b.s=1165));module.exports=c})();