"use strict";exports.id=4413,exports.ids=[4413],exports.modules={897:(a,b,c)=>{c.d(b,{j1:()=>g,z1:()=>h});var d=c(65844),e=c(23867);let f=new Set(e.Hk);function g(a,b,c){let e=(0,d.u_)(b);return!!e&&!!c&&("customer"===a?function(a,b){if(i([b.email,b.customer_email,...b.customerEmails??[],...b.allowedCustomerEmails??[]]).has(a))return!0;let c=a.split("@")[1];return!!c&&(function(a){let b=new Set;return a.forEach(a=>{if(!a)return;let c=a.trim().toLowerCase().replace(/^@/,"");c.includes(".")&&b.add(c)}),b})([b.customerDomain,b.orgDomain,...b.allowedCustomerDomains??[]]).has(c)}(e,c):"supplier"===a&&function(a,b){if(i([b.assigned_supplier_email,b.assignedSupplierEmail,...b.allowedSupplierEmails??[],...j(b.assignments),...j(b.supplierAssignments)]).has(a))return!0;let c=i(b.supplierContext?.verifiedEmails??[]);if(b.supplierContext?.verifiedAccess&&c.has(a))return!0;let e=(0,d.u_)(b.email??null);return!!e&&e===a}(e,c))}function h(a,b){var c;if("supplier"!==a||!b||!1===b.accessGranted||!1===b.allowBids||!0===b.bidLocked)return!1;let d=(0,e.Ao)(b.status);return!!f.has(d)&&"accepted"!==((c=b.existingBidStatus)?c.trim().toLowerCase():null)}function i(a){let b=new Set;return a.forEach(a=>{let c=(0,d.u_)(a??null);c&&b.add(c)}),b}function j(a){return a&&0!==a.length?a.map(a=>a?.supplier_email??a?.email??null):[]}},33968:(a,b,c)=>{c.d(b,{a:()=>g});var d=c(75338),e=c(81171),f=c(39875);function g({currentLabel:a,nextState:b,variant:c="emerald",className:g}){let h="blue"===c?{currentBadge:"border-blue-500/40 bg-blue-500/10 text-blue-100",nextBadge:"border-slate-800 bg-slate-900/60 text-slate-200"}:{currentBadge:"border-emerald-500/40 bg-emerald-500/10 text-emerald-100",nextBadge:"border-slate-800 bg-slate-900/60 text-slate-200"};return(0,d.jsxs)("div",{className:(0,e.A)("rounded-xl border border-slate-900/60 bg-slate-950/40 p-3",g),children:[(0,d.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Workflow"}),(0,d.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs font-semibold",children:[(0,d.jsxs)("span",{className:(0,e.A)("inline-flex items-center rounded-full px-3 py-1",h.currentBadge),children:["Current: ",a]}),(0,d.jsx)("span",{className:"text-slate-500",children:"→"}),(0,d.jsx)("span",{className:(0,e.A)("inline-flex items-center rounded-full border px-3 py-1",b?h.nextBadge:"border-emerald-500/30 text-emerald-200"),children:b?(0,f.uJ)(b):"Final milestone"})]}),(0,d.jsx)("p",{className:"mt-2 text-[11px] uppercase tracking-wide text-slate-500",children:b?"Up next once the team advances this RFQ.":"This RFQ has reached the end of the workflow."})]})}},39875:(a,b,c)=>{c.d(b,{CA:()=>g,uJ:()=>h});let d=new Map([["in_review","reviewing"],["in review","reviewing"],["review","reviewing"],["matching","supplier_matching"],["supplier match","supplier_matching"],["quoted","quoted"],["pricing","quoted"],["approved","approved"],["greenlit","approved"],["in_production","in_production"],["in production","in_production"],["production","in_production"],["shipped","shipped"],["delivered","delivered"],["submitted","submitted"]]),e=["submitted","reviewing","supplier_matching","quoted","approved","in_production","shipped","delivered"],f=new Set(e);function g(a){let b=function(a){if(!a)return null;let b=a.trim().toLowerCase();return f.has(b)?b:d.get(b)??null}(a);if(!b)return null;let c=e.indexOf(b);return -1===c||c>=e.length-1?null:e[c+1]}function h(a){return a?a.split("_").map(a=>a.length>0?a.charAt(0).toUpperCase()+a.slice(1):a).join(" "):"—"}},65844:(a,b,c)=>{c.d(b,{u_:()=>d});function d(a){if(!a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}},67986:(a,b,c)=>{c.d(b,{U:()=>e});var d=c(33358);function e(a,b){let c=(0,d.Ao)(a.status??d._A),e=d.GM[c]??"Unknown",f=[b?.first_name,b?.last_name].filter(a=>"string"==typeof a&&a.trim().length>0).map(a=>(a??"").trim()).join(" ").trim()||("string"==typeof a.customer_name&&a.customer_name.trim().length>0?a.customer_name.trim():"Customer"),g="string"==typeof a.email&&a.email.includes("@")?a.email:null,h=("string"==typeof b?.company&&(b?.company??"").trim().length>0?b?.company:null)||("string"==typeof a.company&&a.company.trim().length>0?a.company:null),i="string"==typeof b?.notes&&b.notes.trim().length>0?b.notes:null,j="number"==typeof a.price?a.price:"string"==typeof a.price?Number(a.price):null,k="number"==typeof j&&Number.isFinite(j)?j:null,l="string"==typeof a.currency&&a.currency.trim().length>0?a.currency.trim().toUpperCase():null;return{status:c,statusLabel:e,customerName:f,customerEmail:g,companyName:h,intakeNotes:i,priceValue:k,currencyValue:l,targetDateValue:"string"==typeof a.target_date&&a.target_date.trim().length>0?a.target_date:null,dfmNotes:"string"==typeof a.dfm_notes&&a.dfm_notes.trim().length>0?a.dfm_notes:null}}},86432:(a,b,c)=>{c.d(b,{Pl:()=>e.Pl,fd:()=>d.fd,wN:()=>e.wN,jp:()=>d.jp,WP:()=>d.WP,D:()=>e.D,m9:()=>d.m9,KP:()=>d.KP,ZS:()=>d.ZS,G_:()=>d.G_,rs:()=>d.rs});var d=c(31722),e=c(39455);c(50904),c(897),c(23696),c(23867)},99066:(a,b,c)=>{c.d(b,{y:()=>h});var d=c(12831),e=c(6173),f=c(81320),g=c(25049);async function h(a,b){try{let c,h=!!b?.safeOnly,i=null;if(h){let{data:b,error:c}=await d.w9.from("quotes_with_uploads").select(g.L.join(",")).eq("id",a).maybeSingle();if(c&&console.error("Portal workspace loader: failed to load quote",c),!b)return{ok:!1,data:null,error:"Quote not found"};let{data:e,error:f}=await d.w9.from("quotes").select("customer_id,dfm_notes,internal_notes").eq("id",a).maybeSingle();f&&console.error("Portal workspace loader: failed to load quote extras",f),i={...b,customer_id:e?.customer_id??null,dfm_notes:e?.dfm_notes??null,internal_notes:e?.internal_notes??null}}else{let{data:b,error:c}=await d.w9.from("quotes_with_uploads").select("*").eq("id",a).maybeSingle();if(c&&console.error("Portal workspace loader: failed to load quote",c),!b)return{ok:!1,data:null,error:"Quote not found"};i=b}let j=null;if(i.upload_id){let{data:a,error:b}=await d.w9.from("uploads").select("first_name,last_name,phone,company,manufacturing_process,quantity,shipping_postal_code,export_restriction,rfq_reason,notes,itar_acknowledged,terms_accepted,file_name,file_path,mime_type").eq("id",i.upload_id).maybeSingle();b?console.error("Portal workspace loader: failed to load upload meta",b):a&&(j=a,c={file_name:a.file_name,file_path:a.file_path,mime_type:a.mime_type??void 0})}let k=h,l=!1,m={includeFilesTable:!h};void 0!==c&&(m.uploadFileOverride=c),m.onFilesError=b=>{k=!0,l=!0,console.error("Portal workspace loader: files query failed",{quoteId:a,error:b})};let n=await (0,e.Q)(i,m),{messages:o,error:p}=await (0,f.xF)(i.id),q=k||l;return{ok:!0,data:{quote:i,uploadMeta:j,filePreviews:n,messages:o??[],messagesError:p,filesUnavailable:q},error:q?"files-unavailable":p??null}}catch(b){return console.error("Portal workspace loader: unexpected error",{quoteId:a,error:b}),{ok:!1,data:null,error:"Unexpected error loading quote workspace"}}}}};