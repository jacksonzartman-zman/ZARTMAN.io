exports.id=168,exports.ids=[168],exports.modules={6173:(a,b,c)=>{"use strict";c.d(b,{Q:()=>f});var d=c(12831);let e=process.env.SUPABASE_CAD_BUCKET||process.env.NEXT_PUBLIC_CAD_BUCKET||process.env.NEXT_PUBLIC_SUPABASE_STORAGE_BUCKET||"cad";async function f(a){try{let{data:b,error:c}=await d.w9.from("files").select("storage_path,bucket_id,filename,mime").eq("quote_id",a.id).order("created_at",{ascending:!0});c&&console.error("Failed to load files for quote",a.id,c);let e=null;if(a.upload_id){let{data:b,error:c}=await d.w9.from("uploads").select("file_path,file_name").eq("id",a.upload_id).maybeSingle();c?console.error("Failed to load upload for quote",a.upload_id,c):e=b}let f=function(a,b){let c=[];return a?.forEach(a=>{a?.storage_path&&c.push({storagePath:a.storage_path,bucketId:a.bucket_id,fileName:a.filename,mime:a.mime})}),b?.file_path&&c.push({storagePath:b.file_path,bucketId:null,fileName:b.file_name}),c}(b??[],e),i=new Map,j=function(a){let b=[],c=a=>{"string"==typeof a&&a.trim().length>0&&b.push(a.trim())};return[a.file_names,a.upload_file_names].forEach(a=>{Array.isArray(a)&&a.forEach(c)}),0===b.length&&c(a.file_name),b}(a),k=f.map(a=>a.fileName??h(a.storagePath)??null).filter(a=>!!a?.trim()),l=j.length>0?j:k.length>0?k:[],m=[],n=new Set;for(let a=0;a<l.length;a+=1){let b=l[a]||`File ${a+1}`,c=function(a,b){let c=a?.toLowerCase().trim();if(c)return b.find(a=>{let b=a.fileName?.toLowerCase().trim();return!!b&&b===c||(h(a.storagePath)?.toLowerCase().trim()??"")===c})}(b,f);c&&n.add(c.storagePath);let d=c?await g(c,i):{signedUrl:null,fileName:b,reason:"Preview not available for this file yet."};m.push({id:c?.storagePath??`${a}-${b}`,label:b,fileName:d.fileName??b,signedUrl:d.signedUrl,fallbackMessage:d.reason})}for(let[a,b]of f.filter(a=>!n.has(a.storagePath)).entries()){let c=b.fileName??h(b.storagePath)??`File ${m.length+1}`,d=await g(b,i);m.push({id:`${b.storagePath}-${a}`,label:c,fileName:d.fileName??c,signedUrl:d.signedUrl,fallbackMessage:d.reason})}return m}catch(a){return console.error("Unexpected CAD preview error",a),[]}}async function g(a,b){let c,f=`${a.bucketId??"default"}:${a.storagePath}`;if(b.has(f))return b.get(f);if(!function(a){let b=a.fileName?.toLowerCase()??"",c=a.storagePath.toLowerCase(),d=a.mime?.toLowerCase()??"";return b.endsWith(".stl")||c.endsWith(".stl")||d.includes("stl")}(a))return c={signedUrl:null,fileName:a.fileName??h(a.storagePath)??void 0,reason:"Only STL files are supported for preview today."},b.set(f,c),c;let g=function(a,b){if(!a)return null;let c=a.trim().replace(/^\/+/,"");if(!c)return null;let d=b?.trim()||null;return(!d&&c.startsWith(`${e}/`)&&(d=e,c=c.slice(e.length+1)),d||(d=e),c.startsWith(`${d}/`)&&(c=c.slice(d.length+1)),c)?{bucket:d,path:c}:null}(a.storagePath,a.bucketId);if(!g)return c={signedUrl:null,fileName:a.fileName??h(a.storagePath)??void 0,reason:"Missing storage path for CAD file."},b.set(f,c),c;let{data:i,error:j}=await d.w9.storage.from(g.bucket).createSignedUrl(g.path,3600);return j||!i?.signedUrl?(console.error("Failed to create CAD signed URL",j),c={signedUrl:null,fileName:a.fileName??h(a.storagePath)??void 0,reason:"Unable to generate CAD preview link right now."}):c={signedUrl:i.signedUrl,fileName:a.fileName??h(a.storagePath)??void 0},b.set(f,c),c}function h(a){if(!a)return;let b=a.split("/");return b[b.length-1]||void 0}},7633:(a,b,c)=>{"use strict";c.d(b,{$p:()=>i,LA:()=>j,Zo:()=>f,mh:()=>k,mj:()=>g,nu:()=>h});let d=["submitted","in_review","quoted","approved","rejected"],e={new:"submitted",on_hold:"in_review",closed_lost:"rejected",draft:"submitted"},f="submitted";function g(a){return"string"==typeof a&&d.includes(a)}function h(a,b=f){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(e[b])return e[b]}return b}function i(a){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(g(b))return b}return null}let j={submitted:"Submitted",in_review:"In review",quoted:"Quoted",approved:"Approved",rejected:"Rejected"},k=[...d]},9965:(a,b,c)=>{"use strict";c.d(b,{r:()=>e});let d="en-US";function e(a,{includeTime:b=!1,fallback:c="—"}={}){let f=function(a){if(null==a)return null;let b=a instanceof Date?a:new Date(a);return Number.isNaN(b.getTime())?null:b}(a);if(!f)return c;let g=f.toLocaleDateString(d,{month:"short",day:"numeric",year:"numeric"});if(!b)return g;let h=f.toLocaleTimeString(d,{hour:"numeric",minute:"2-digit"});return`${g} \xb7 ${h}`}},11802:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},12831:(a,b,c)=>{"use strict";c.d(b,{E2:()=>i,qr:()=>h,w9:()=>j});var d=c(36464);let e=process.env.SUPABASE_URL??process.env.NEXT_PUBLIC_SUPABASE_URL,f=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,g=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e)throw Error("SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL is required (check your env vars).");let h=()=>{if(!f)throw Error("NEXT_PUBLIC_SUPABASE_ANON_KEY is required");return(0,d.UU)(e,f,{auth:{persistSession:!1}})},i=()=>{if(!g)throw Error("SUPABASE_SERVICE_ROLE_KEY is required");return(0,d.UU)(e,g,{auth:{persistSession:!1}})},j=i()},13951:(a,b,c)=>{"use strict";c.d(b,{t:()=>j});var d=c(75338),e=c(81171),f=c(9965);let g={admin:"border-emerald-500/40 bg-emerald-500/10 text-emerald-300",customer:"border-sky-500/40 bg-sky-500/10 text-sky-300",supplier:"border-amber-500/40 bg-amber-500/10 text-amber-200"},h={admin:"Admin",customer:"Customer",supplier:"Supplier"},i={admin:"bg-emerald-400 text-slate-950 border border-emerald-300/70 shadow-lift-sm",customer:"bg-slate-900 text-slate-100 border border-slate-800/80",supplier:"bg-blue-500/80 text-slate-950 border border-blue-300/70"};function j({messages:a,heading:b,description:c,messageCount:j,isLoading:l,error:m,emptyState:n,containerClassName:o}){let p=a??[],q="number"==typeof j?j:p.length,r=p.length>0;return(0,d.jsxs)("div",{className:(0,e.A)("space-y-3",o),children:[(!!b||!!c||"number"==typeof j)&&(0,d.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[b?(0,d.jsx)("h2",{className:"text-lg font-semibold text-slate-50",children:b}):null,c?(0,d.jsx)("p",{className:"text-sm text-slate-400",children:c}):null]}),(0,d.jsxs)("span",{className:"text-xs text-slate-500",children:[q," ",1===q?"message":"messages"]})]}),m&&(0,d.jsx)("p",{className:"rounded-xl border border-red-500/30 bg-red-500/10 px-3 py-2 text-xs text-red-200",role:"status",children:m}),l?(0,d.jsx)(k,{}):r?(0,d.jsx)("div",{className:"md:max-h-[420px] md:overflow-y-auto md:pr-2",children:(0,d.jsx)("ol",{className:"flex flex-col gap-3",children:p.map(a=>{var b;let c="admin"===a.author_type;return(0,d.jsx)("li",{className:(0,e.A)("flex w-full",c?"justify-end":"justify-start"),children:(0,d.jsxs)("div",{className:"flex max-w-[92%] flex-col gap-1.5 sm:max-w-[70%]",children:[(0,d.jsxs)("div",{className:(0,e.A)("flex flex-wrap items-center gap-2 text-[11px] font-semibold uppercase tracking-wide text-slate-500",c?"justify-end text-right":"text-left"),children:[(0,d.jsx)("span",{className:(b=a.author_type,`inline-flex items-center rounded-full border px-2.5 py-0.5 text-[11px] font-semibold uppercase tracking-wide ${g[b]??g.admin}`),children:h[a.author_type]??h.admin}),(0,d.jsx)("span",{className:"text-slate-400",children:(0,f.r)(a.created_at,{includeTime:!0})}),a.author_name&&(0,d.jsx)("span",{className:"text-slate-500",children:a.author_name})]}),(0,d.jsx)("div",{className:(0,e.A)("whitespace-pre-line rounded-2xl border px-3.5 py-2.5 text-sm leading-relaxed",i[a.author_type]??i.customer,c?"rounded-tr-sm":"rounded-tl-sm"),children:a.body})]})},a.id)})})}):n??(0,d.jsx)("p",{className:"rounded-2xl border border-dashed border-slate-800/70 bg-black/30 px-4 py-4 text-sm text-slate-400",children:"No messages yet. Share the first update to kick things off."})]})}function k(){return(0,d.jsx)("div",{className:"space-y-3",children:[0,1,2].map(a=>(0,d.jsx)("div",{className:(0,e.A)("flex justify-start",a%2==0?"justify-end":"justify-start"),children:(0,d.jsxs)("div",{className:"flex max-w-[75%] flex-col gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 text-[11px] text-slate-600",children:[(0,d.jsx)("span",{className:"inline-flex h-4 w-20 animate-pulse rounded-full bg-slate-800/70"}),(0,d.jsx)("span",{className:"inline-flex h-3 w-24 animate-pulse rounded-full bg-slate-900/60"})]}),(0,d.jsx)("div",{className:"h-16 animate-pulse rounded-2xl bg-slate-900/60"})]})},a))})}},24207:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=c(84339);function e(a){let{reason:b,children:c}=a;throw Object.defineProperty(new d.BailoutToCSRError(b),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},32999:(a,b,c)=>{"use strict";c.d(b,{m:()=>f,n4:()=>g,tJ:()=>h});let d="inline-flex items-center justify-center rounded-full font-semibold transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 disabled:cursor-not-allowed disabled:opacity-60",e={md:"px-5 py-2 text-sm",sm:"px-4 py-1.5 text-xs"},f=e,g=`${d} ${e.md} bg-emerald-400 text-slate-950 shadow-lift-sm hover:bg-emerald-300 focus-visible:outline-emerald-300`,h=`${d} ${e.md} border border-emerald-400/60 bg-transparent text-emerald-200 hover:bg-emerald-400/10 focus-visible:outline-emerald-400`},33540:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"default",{enumerable:!0,get:function(){return e}});let d=c(35288)._(c(43972));function e(a,b){var c;let e={};"function"==typeof a&&(e.loader=a);let f={...e,...b};return(0,d.default)({...f,modules:null==(c=f.loadableGenerated)?void 0:c.modules})}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},37331:(a,b,c)=>{"use strict";c.d(b,{QuoteFilesCard:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call QuoteFilesCard() from the server but QuoteFilesCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/src/app/admin/quotes/[id]/QuoteFilesCard.tsx","QuoteFilesCard")},43972:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"default",{enumerable:!0,get:function(){return j}});let d=c(21124),e=c(38301),f=c(24207),g=c(52402);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},50904:(a,b,c)=>{"use strict";c.d(b,{w9:()=>g});var d=c(27982);let e=process.env.SUPABASE_URL??process.env.NEXT_PUBLIC_SUPABASE_URL;process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;let f=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e)throw Error("SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL is required (check your env vars).");let g=(()=>{if(!f)throw Error("SUPABASE_SERVICE_ROLE_KEY is required");return(0,d.UU)(e,f,{auth:{persistSession:!1}})})()},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f,metadata:()=>e});var d=c(75338);c(61135);let e={title:"Zartman.io",description:"Manufacturing OS — quotes, messaging, suppliers"};function f({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsx)("body",{children:a})})}},51970:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},52402:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=c(21124),e=c(23312),f=c(29294),g=c(61348);function h(a){let{moduleIds:b}=a,c=f.workAsyncStorage.getStore();if(void 0===c)return null;let h=[];if(c.reactLoadableManifest&&b){let a=c.reactLoadableManifest;for(let c of b){if(!a[c])continue;let b=a[c].files;h.push(...b)}}return 0===h.length?null:(0,d.jsx)(d.Fragment,{children:h.map(a=>{let b=c.assetPrefix+"/_next/"+(0,g.encodeURIPath)(a);return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:b,rel:"stylesheet",as:"style"},a):((0,e.preload)(b,{as:"script",fetchPriority:"low"}),null)})})}},54398:(a,b,c)=>{"use strict";c.d(b,{QuoteFilesCard:()=>m});var d=c(21124),e=c(38301),f=c(43249),g=c(33540);let h=c.n(g)()(async()=>{},{loadableGenerated:{modules:["components/CadViewerClient.tsx -> ./CadViewer"]},ssr:!1,loading:()=>(0,d.jsx)(j,{})});function i(a){return(0,d.jsx)(h,{...a})}function j({height:a=320}){let b="number"==typeof a&&Number.isFinite(a)&&a>0?a:320;return(0,d.jsx)("div",{className:"w-full",children:(0,d.jsx)("div",{className:"relative overflow-hidden rounded-xl border border-slate-900/60 bg-slate-950/60",style:{height:b},children:(0,d.jsx)("div",{className:"flex h-full items-center justify-center px-6 text-center",children:(0,d.jsx)("p",{className:"text-sm text-slate-500",children:"Preparing 3D preview…"})})})})}function k({fileName:a,fileUrl:b,fallbackMessage:c,height:e=360}){return(0,d.jsx)(i,{src:b,fileName:a,fallbackMessage:c,height:e})}var l=c(32999);function m({files:a,id:b,className:c}){let[g,h]=(0,e.useState)(null),i=(0,e.useMemo)(()=>a.find(a=>a.id===g)??null,[g,a]),j=(0,e.useCallback)(()=>{h(null)},[]);return(0,d.jsxs)("section",{id:b,className:(0,f.A)("rounded-2xl border border-slate-800 bg-slate-950/60 px-5 py-4",c),children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Files"}),(0,d.jsx)("p",{className:"text-sm text-slate-400",children:"Click a file to open the 3D preview modal."})]}),(0,d.jsxs)("span",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:[a.length," attached"]})]}),(0,d.jsx)("div",{className:"mt-4 space-y-2",children:0===a.length?(0,d.jsx)("p",{className:"rounded-xl border border-dashed border-slate-900/70 bg-black/20 px-4 py-5 text-sm text-slate-500",children:"No files listed."}):a.map(a=>(0,d.jsxs)("button",{type:"button",onClick:()=>h(a.id),className:"group flex w-full items-center justify-between rounded-xl border border-slate-900/60 bg-slate-950/20 px-4 py-3 text-left transition hover:border-slate-800 hover:bg-slate-900/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-emerald-400/70",children:[(0,d.jsxs)("div",{className:"min-w-0",children:[(0,d.jsx)("p",{className:"truncate text-sm font-medium text-slate-100",children:a.label}),(0,d.jsx)("p",{className:"mt-0.5 text-xs text-slate-500",children:a.signedUrl?"Interactive STL available":a.fallbackMessage??"Preview not available yet"})]}),(0,d.jsx)("span",{className:(0,f.A)(l.tJ,l.m.sm,"whitespace-nowrap",!a.signedUrl&&"opacity-70"),children:"View model"})]},a.id))}),i&&(0,d.jsx)(n,{file:i,onClose:j})]})}function n({file:a,onClose:b}){let c=(0,e.useRef)(null);return(0,e.useRef)(null),(0,d.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-8",children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:b,"aria-hidden":"true"}),(0,d.jsxs)("div",{ref:c,role:"dialog","aria-modal":"true","aria-label":`Preview for ${a.label}`,tabIndex:-1,className:"relative z-10 w-full max-w-3xl rounded-3xl border border-slate-800 bg-slate-950/95 shadow-2xl outline-none",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between border-b border-slate-900 px-6 py-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"File preview"}),(0,d.jsx)("h3",{className:"mt-1 text-lg font-semibold text-slate-50",children:a.label})]}),(0,d.jsx)("button",{type:"button",onClick:b,className:"rounded-full border border-slate-800 bg-slate-900/70 p-2 text-slate-400 transition hover:text-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-emerald-400/70","aria-label":"Close preview",children:(0,d.jsx)("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",children:(0,d.jsx)("path",{d:"M5 5l10 10M15 5L5 15",stroke:"currentColor",strokeWidth:1.6,strokeLinecap:"round"})})})]}),(0,d.jsx)("div",{className:"px-6 py-6",children:(0,d.jsx)(k,{fileName:a.fileName??a.label,fileUrl:a.signedUrl,fallbackMessage:a.fallbackMessage})}),(0,d.jsx)("div",{className:"flex justify-end gap-3 border-t border-slate-900 px-6 py-4",children:(0,d.jsx)("button",{type:"button",onClick:b,className:(0,f.A)(l.tJ,l.m.sm),children:"Close"})})]})]})}},60029:()=>{},61135:()=>{},61348:(a,b)=>{"use strict";function c(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"encodeURIPath",{enumerable:!0,get:function(){return c}})},81320:(a,b,c)=>{"use strict";c.d(b,{xF:()=>e});var d=c(12831);async function e(a){let b=a?.trim();if(!b)return{messages:[],error:"quoteId is required"};try{let{data:c,error:e}=await d.w9.from("quote_messages").select("id,quote_id,author_type,author_name,author_email,body,created_at").eq("quote_id",b).order("created_at",{ascending:!0});if(e)return console.error("loadQuoteMessages: query failed",{quoteId:a,error:e}),{messages:[],error:"Unable to load messages right now."};return{messages:c??[],error:null}}catch(a){return console.error("loadQuoteMessages: unexpected error",{quoteId:b,error:a}),{messages:[],error:"Unable to load messages right now."}}}},82393:(a,b,c)=>{"use strict";c.d(b,{Ak:()=>f,ES:()=>g,hX:()=>e});var d=c(50904);async function e({quoteId:a,body:b}){return h({quoteId:a,body:b,authorType:"admin",authorName:"Zartman admin",authorEmail:null})}async function f({quoteId:a,body:b,authorName:c,authorEmail:d}){return h({quoteId:a,body:b,authorType:"customer",authorName:i(c),authorEmail:j(d)})}async function g({quoteId:a,body:b,authorName:c,authorEmail:d}){return h({quoteId:a,body:b,authorType:"supplier",authorName:i(c),authorEmail:j(d)})}async function h({quoteId:a,body:b,authorType:c,authorName:e,authorEmail:f}){let g=a?.trim(),h=b?.trim(),i="admin"===c||"customer"===c||"supplier"===c?c:null,j="string"==typeof e?e.trim().slice(0,120):null,k="string"==typeof f?f.trim().toLowerCase():null;if(!g||!h||!i)return{data:null,error:"Missing message parameters."};try{let{data:a,error:b}=await d.w9.from("quote_messages").insert({quote_id:g,author_type:i,author_name:j,author_email:k,body:h}).select("id,quote_id,author_type,author_name,author_email,body,created_at").single();if(b||!a)return console.error("createQuoteMessage: insert failed",{quoteId:g,authorType:i,error:b}),{data:null,error:"Failed to post message."};return{data:a,error:null}}catch(a){return console.error("createQuoteMessage: unexpected error",a),{data:null,error:"Failed to post message."}}}function i(a){if("string"!=typeof a)return null;let b=a.trim().slice(0,120);return b.length>0?b:null}function j(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}},87645:()=>{},88437:(a,b,c)=>{"use strict";c.d(b,{QuoteWorkspaceTabs:()=>g});var d=c(21124),e=c(38301),f=c(43249);function g({tabs:a,defaultTab:b="summary"}){let c=(0,e.useId)(),[g,h]=(0,e.useState)(a.find(a=>a.id===b)?.id??a[0]?.id??"summary"),i=(0,e.useMemo)(()=>a.filter((a,b,c)=>a&&"string"==typeof a.id&&c.findIndex(b=>b.id===a.id)===b),[a]);return 0===i.length?null:(0,d.jsxs)("div",{className:"space-y-5",children:[(0,d.jsx)("div",{className:"overflow-x-auto pb-1",children:(0,d.jsx)("div",{className:"flex min-w-max gap-2",role:"tablist","aria-label":"Quote workspace navigation",children:i.map(a=>{let b=a.id===g,e=`${c}-tab-${a.id}`,i=`${c}-panel-${a.id}`;return(0,d.jsxs)("button",{id:e,type:"button",role:"tab","aria-selected":b,"aria-controls":i,onClick:()=>h(a.id),className:(0,f.A)("rounded-full border px-3 py-1 text-xs font-semibold transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",b?"border-emerald-400 bg-emerald-500/20 text-emerald-100 shadow-[0_0_25px_rgba(16,185,129,0.25)]":"border-slate-800 bg-slate-900/70 text-slate-300 hover:border-emerald-400 hover:text-emerald-100"),children:[(0,d.jsx)("span",{children:a.label}),"number"==typeof a.count&&(0,d.jsx)("span",{className:(0,f.A)("ml-2 rounded-full border px-2 py-0.5 text-[10px]",b?"border-transparent bg-slate-900/40 text-emerald-100/80":"border-slate-800 bg-slate-950/70 text-slate-400"),children:a.count})]},a.id)})})}),(0,d.jsx)("div",{children:i.map(a=>{let b=a.id===g,e=`${c}-panel-${a.id}`,h=`${c}-tab-${a.id}`;return(0,d.jsx)("div",{id:e,role:"tabpanel","aria-labelledby":h,className:(0,f.A)("space-y-4",b?"block":"hidden"),"aria-hidden":!b,children:a.content},a.id)})})]})}},98719:(a,b,c)=>{"use strict";c.d(b,{QuoteWorkspaceTabs:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call QuoteWorkspaceTabs() from the server but QuoteWorkspaceTabs is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/src/app/admin/quotes/[id]/QuoteWorkspaceTabs.tsx","QuoteWorkspaceTabs")}};