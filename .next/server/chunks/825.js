exports.id=825,exports.ids=[825],exports.modules={23117:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,65169,23))},31143:(a,b,c)=>{"use strict";c.d(b,{A:()=>i});var d=c(75338),e=c(65169),f=c.n(e),g=c(81171);let h={customer:{title:"Customer workspace",tagline:"Track RFQs, quotes, orders, and messages in one place.",accent:"text-emerald-300"},supplier:{title:"Supplier workspace",tagline:"Manage inbound RFQs and collaborate with customers.",accent:"text-blue-300"}};function i({role:a,children:b,userName:c}){let e=h[a];return(0,d.jsxs)("div",{className:"min-h-screen bg-slate-950 text-slate-50",children:[(0,d.jsx)("header",{className:"border-b border-slate-900 bg-slate-950/90 backdrop-blur",children:(0,d.jsxs)("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-4 py-6 sm:flex-row sm:items-center sm:justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{className:(0,g.A)("text-xs font-semibold uppercase tracking-[0.3em]",e.accent),children:[a," portal"]}),(0,d.jsx)("h1",{className:"mt-1 text-2xl font-semibold text-white",children:e.title}),(0,d.jsx)("p",{className:"text-sm text-slate-400",children:e.tagline})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,d.jsx)("div",{className:"rounded-full border border-slate-800 px-4 py-2 text-slate-200",children:c??"Guest user"}),(0,d.jsx)(f(),{href:"/",className:"rounded-full border border-slate-800 px-4 py-2 text-xs font-semibold text-emerald-300 transition hover:border-emerald-400 hover:text-emerald-200",children:"Back to site"})]})]})}),(0,d.jsx)("main",{className:"mx-auto max-w-6xl px-4 py-10 space-y-6",children:b})]})}},47085:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,3991,23))},64811:(a,b,c)=>{"use strict";async function d(a){if(void 0!==a)return await a}function e(a,b){var c;if(!a)return;if(c=a,"function"==typeof c?.get)return a.get(b)??void 0;let d=a[b];return Array.isArray(d)?d[0]:d}function f(a){if(!a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}function g(a){return a?a.startsWith("Q-")?a:`#${a.slice(0,6)}`:"Quote"}function h(a){return Array.isArray(a)?a[0]:a??void 0}c.d(b,{Ol:()=>d,VC:()=>e,nb:()=>h,u_:()=>f,xt:()=>g})},80026:(a,b,c)=>{"use strict";c.d(b,{D:()=>k,iS:()=>i,g1:()=>j,KP:()=>e,_r:()=>p});var d=c(12831);async function e(a){let b=function(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}(a);if(!b)return null;try{let{data:a,error:c}=await d.w9.from("suppliers").select("*").eq("primary_email",b).maybeSingle();if(c)return console.error("loadSupplierProfile: supplier lookup failed",{email:b,error:c}),null;if(!a)return null;let[e,f]=await Promise.all([g(a.id),h(a.id)]);return{supplier:a,capabilities:e,documents:f}}catch(a){return console.error("loadSupplierProfile: unexpected error",{email:b,error:a}),null}}async function f(a){if(!a)return null;try{let{data:b,error:c}=await d.w9.from("suppliers").select("*").eq("id",a).maybeSingle();if(c)return console.error("loadSupplierById: lookup failed",{supplierId:a,error:c}),null;return b??null}catch(b){return console.error("loadSupplierById: unexpected error",{supplierId:a,error:b}),null}}async function g(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_capabilities").select("*").eq("supplier_id",a).order("created_at",{ascending:!0});if(c)return console.error("listSupplierCapabilities: query failed",{supplierId:a,error:c}),[];return b??[]}catch(b){return console.error("listSupplierCapabilities: unexpected error",{supplierId:a,error:b}),[]}}async function h(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_documents").select("*").eq("supplier_id",a).order("uploaded_at",{ascending:!1});if(c)return console.error("listSupplierDocuments: query failed",{supplierId:a,error:c}),[];return b??[]}catch(b){return console.error("listSupplierDocuments: unexpected error",{supplierId:a,error:b}),[]}}async function i(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_bids").select("*").eq("quote_id",a).order("created_at",{ascending:!1});if(c)return console.error("listSupplierBidsForQuote: query failed",{quoteId:a,error:c}),[];return l(b??[])}catch(b){return console.error("listSupplierBidsForQuote: unexpected error",{quoteId:a,error:b}),[]}}async function j(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_bids").select("*").eq("supplier_id",a).order("updated_at",{ascending:!1});if(c)return console.error("listSupplierBidsForSupplier: query failed",{supplierId:a,error:c}),[];return l(b??[])}catch(b){return console.error("listSupplierBidsForSupplier: unexpected error",{supplierId:a,error:b}),[]}}async function k(a,b){if(!a||!b)return null;try{let{data:c,error:e}=await d.w9.from("supplier_bids").select("*").eq("quote_id",a).eq("supplier_id",b).maybeSingle();if(e)return console.error("getSupplierBidForQuote: lookup failed",{quoteId:a,supplierId:b,error:e}),null;return c??null}catch(c){return console.error("getSupplierBidForQuote: unexpected error",{quoteId:a,supplierId:b,error:c}),null}}async function l(a){if(0===a.length)return[];let b=Array.from(new Set(a.map(a=>a.supplier_id).filter(Boolean))),[c,d]=await Promise.all([m(b),n(b)]),e=new Map;c.forEach(a=>e.set(a.id,a));let f=new Map;return d.forEach(a=>{let b=f.get(a.supplier_id)??[];(a.certifications??[]).filter(a=>"string"==typeof a&&a.trim().length>0).forEach(a=>{b.includes(a)||b.push(a)}),f.set(a.supplier_id,b)}),a.map(a=>({...a,supplier:e.get(a.supplier_id)??null,certifications:f.get(a.supplier_id)??[]}))}async function m(a){if(0===a.length)return[];let{data:b,error:c}=await d.w9.from("suppliers").select("*").in("id",a);return c?(console.error("selectSuppliersByIds: query failed",{supplierIds:a,error:c}),[]):b??[]}async function n(a){if(0===a.length)return[];let{data:b,error:c}=await d.w9.from("supplier_capabilities").select("*").in("supplier_id",a);return c?(console.error("selectCapabilitiesBySupplierIds: query failed",{supplierIds:a,error:c}),[]):b??[]}let o=["submitted","in_review","quoted"];async function p(a){let b=await f(a);if(!b)return[];let[c,d,e]=await Promise.all([g(b.id),t(b.primary_email),u(b.id)]),h=function(a){let b=new Set,c=new Set;return a.forEach(a=>{let d=q(a.process);d&&b.add(d),(a.materials??[]).forEach(a=>{let b=function(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}(a);b&&c.add(b)})}),{processes:b,materials:c}}(c);if(0===h.processes.size)return[];let i=new Set;d.forEach(a=>{a?.quote_id&&i.add(a.quote_id)}),e.forEach(a=>{a?.quote_id&&i.add(a.quote_id)});let j=b.verified,k=await r();if(0===k.length)return[];let l=await s(k),m=[];for(let a of k){let b=a.upload_id?l.get(a.upload_id):null,c=b?.manufacturing_process??null,d=q(c);if(!(d&&function(a,b){if(b.has(a))return!0;for(let c of b)if(a.includes(c)||c.includes(a))return!0;return!1}(d,h.processes)))continue;let e=a.id;if(!(j||e&&i.has(e)))continue;let f=function(a,b){if(!a||0===b.size)return[];let c=[a.notes??"",a.rfq_reason??""].join(" ").toLowerCase(),d=[];return b.forEach(a=>{0!==a.length&&c.includes(a)&&d.push(a)}),d}(b,h.materials),g=function({createdAt:a,materialMatches:b}){let c;if(c=1+.5*b.length,a){let b=Date.parse(a);Number.isNaN(b)||(c+=Math.max(0,30-(Date.now()-b)/864e5)/10)}return c}({createdAt:a.created_at,materialMatches:f});if(m.push({quoteId:e,quote:a,processHint:c,materialMatches:f,score:g,createdAt:a.created_at??null,quantityHint:b?.quantity??null}),m.length>=20)break}return m.sort((a,b)=>b.score-a.score)}function q(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}async function r(){try{let{data:a,error:b}=await d.w9.from("quotes_with_uploads").select("id,upload_id,customer_name,email,company,status,price,currency,created_at,updated_at,target_date,file_name,assigned_supplier_email,assigned_supplier_name,internal_notes,dfm_notes").in("status",o).order("created_at",{ascending:!1}).limit(50);if(b)return console.error("matchQuotesToSupplier: quote query failed",{error:b}),[];return a??[]}catch(a){return console.error("matchQuotesToSupplier: unexpected quote error",{error:a}),[]}}async function s(a){let b=Array.from(new Set(a.map(a=>a.upload_id).filter(a=>"string"==typeof a&&a.length>0)));if(0===b.length)return new Map;try{let{data:a,error:c}=await d.w9.from("uploads").select("id,manufacturing_process,quantity,rfq_reason,notes").in("id",b);if(c)return console.error("matchQuotesToSupplier: upload query failed",{error:c}),new Map;let e=new Map;return(a??[]).forEach(a=>{a?.id&&e.set(a.id,a)}),e}catch(a){return console.error("matchQuotesToSupplier: unexpected upload error",{error:a}),new Map}}async function t(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("quote_suppliers").select("quote_id").eq("supplier_email",a);if(c)return console.error("matchQuotesToSupplier: assignment query failed",{email:a,error:c}),[];return b??[]}catch(b){return console.error("matchQuotesToSupplier: assignment unexpected error",{email:a,error:b}),[]}}async function u(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_bids").select("quote_id").eq("supplier_id",a);if(c)return console.error("matchQuotesToSupplier: bid query failed",{supplierId:a,error:c}),[];return b??[]}catch(b){return console.error("matchQuotesToSupplier: bid unexpected error",{supplierId:a,error:b}),[]}}}};