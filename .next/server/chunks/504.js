exports.id=504,exports.ids=[504],exports.modules={3440:(a,b,c)=>{"use strict";c.d(b,{j1:()=>f,z1:()=>g});var d=c(64811);let e=new Set(["submitted","in_review","quoted"]);function f(a,b,c){let e=(0,d.u_)(b);return!!e&&!!c&&("customer"===a?function(a,b){if(h([b.email,b.customer_email,...b.customerEmails??[],...b.allowedCustomerEmails??[]]).has(a))return!0;let c=a.split("@")[1];return!!c&&(function(a){let b=new Set;return a.forEach(a=>{if(!a)return;let c=a.trim().toLowerCase().replace(/^@/,"");c.includes(".")&&b.add(c)}),b})([b.customerDomain,b.orgDomain,...b.allowedCustomerDomains??[]]).has(c)}(e,c):"supplier"===a&&function(a,b){if(h([b.assigned_supplier_email,b.assignedSupplierEmail,...b.allowedSupplierEmails??[],...i(b.assignments),...i(b.supplierAssignments)]).has(a))return!0;let c=h(b.supplierContext?.verifiedEmails??[]);if(b.supplierContext?.verifiedAccess&&c.has(a))return!0;let e=(0,d.u_)(b.email??null);return!!e&&e===a}(e,c))}function g(a,b){if("supplier"!==a||!b||!1===b.accessGranted||!1===b.allowBids||!0===b.bidLocked)return!1;let c=j(b.status);return(!c||!!e.has(c))&&"accepted"!==j(b.existingBidStatus)}function h(a){let b=new Set;return a.forEach(a=>{let c=(0,d.u_)(a??null);c&&b.add(c)}),b}function i(a){return a&&0!==a.length?a.map(a=>a?.supplier_email??a?.email??null):[]}function j(a){return a?a.trim().toLowerCase():null}},3930:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"00f3cdd09fac07953960331187b4b7634e2ce4334d":()=>d.x});var d=c(9736)},7633:(a,b,c)=>{"use strict";c.d(b,{$p:()=>i,LA:()=>j,Zo:()=>f,mh:()=>k,mj:()=>g,nu:()=>h});let d=["submitted","in_review","quoted","approved","rejected"],e={new:"submitted",on_hold:"in_review",closed_lost:"rejected",draft:"submitted"},f="submitted";function g(a){return"string"==typeof a&&d.includes(a)}function h(a,b=f){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(e[b])return e[b]}return b}function i(a){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(g(b))return b}return null}let j={submitted:"Submitted",in_review:"In review",quoted:"Quoted",approved:"Approved",rejected:"Rejected"},k=[...d]},9736:(a,b,c)=>{"use strict";c.d(b,{x:()=>n,A:()=>m});var d=c(75338),e=c(75879);c(68633);var f=c(72224),g=c(76522),h=c(82161),i=c(67285),j=c(84472),k=c(98351);async function l(a){let b=a.limit??12;if(!a.userId&&!a.email)return[];let[c,d]=await Promise.all([a.userId?(0,j.kZ)(a.userId):Promise.resolve(null),a.email?(0,k.KP)(a.email):Promise.resolve(null)]),e=c?(0,i.Y)({customerId:c.id,email:c.email??a.email??null,domain:function(a){if(!a||!a.includes("@"))return null;let[,b]=a.split("@");return b?.toLowerCase()??null}(c.email??a.email??null),limit:b}):Promise.resolve([]),f=d?.supplier?(0,i.E)({supplierId:d.supplier.id,supplierEmail:d.supplier.primary_email??a.email??null,limit:b}):Promise.resolve([]),[g,h]=await Promise.all([e,f]);return[...g.map(a=>({...a,source:"customer",read:!1})),...h.map(a=>({...a,source:"supplier",read:!1}))].sort((a,b)=>{let c=Date.parse(a.timestamp)||0;return(Date.parse(b.timestamp)||0)-c}).slice(0,b)}async function m(){let a=await (0,g.qQ)(),b=a?await l({userId:a.user.id,email:a.user.email??null}):[],c=a?{email:a.user.email??null,displayName:a.user.user_metadata?.company??a.user.user_metadata?.full_name??a.user.email??null}:null;return(0,d.jsx)(f.default,{user:c,signOutAction:a?o:void 0,notifications:b})}let n=async function(){let a=(0,g.MB)();try{await a.auth.signOut()}catch(a){console.error("AppHeader: sign out failed",a)}(0,h.redirect)("/")};(0,e.A)(n,"00f3cdd09fac07953960331187b4b7634e2ce4334d",null);var o=n},11802:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},12831:(a,b,c)=>{"use strict";c.d(b,{E2:()=>i,qr:()=>h,w9:()=>j});var d=c(36464);let e=process.env.SUPABASE_URL??"https://qslztdkptpklopyedkfd.supabase.co/",f="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFzbHp0ZGtwdHBrbG9weWVka2ZkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MTYzMzksImV4cCI6MjA3ODk5MjMzOX0.et6RdF18ioinJKYNNTE0UVA5HvRH1YaXmA2DgRHLPWo",g=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e)throw Error("SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL is required (check your env vars).");let h=()=>{if(!f)throw Error("NEXT_PUBLIC_SUPABASE_ANON_KEY is required");return(0,d.UU)(e,f,{auth:{persistSession:!1}})},i=()=>{if(!g)throw Error("SUPABASE_SERVICE_ROLE_KEY is required");return(0,d.UU)(e,g,{auth:{persistSession:!1}})},j=i()},26261:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,3991,23)),Promise.resolve().then(c.bind(c,91331))},31143:(a,b,c)=>{"use strict";c.d(b,{A:()=>f});var d=c(75338),e=c(9736);function f({children:a}){return(0,d.jsxs)("div",{className:"min-h-screen bg-slate-950 text-slate-50",children:[(0,d.jsx)(e.A,{}),(0,d.jsx)("main",{className:"mx-auto w-full max-w-6xl px-4 py-10 sm:px-6 lg:px-8",children:a})]})}},32999:(a,b,c)=>{"use strict";c.d(b,{m:()=>f,n4:()=>g,tJ:()=>h});let d="inline-flex items-center justify-center rounded-full font-semibold transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 disabled:cursor-not-allowed disabled:opacity-60",e={md:"px-5 py-2 text-sm",sm:"px-4 py-1.5 text-xs"},f=e,g=`${d} ${e.md} bg-emerald-400 text-slate-950 shadow-lift-sm hover:bg-emerald-300 focus-visible:outline-emerald-300`,h=`${d} ${e.md} border border-emerald-400/60 bg-transparent text-emerald-200 hover:bg-emerald-400/10 focus-visible:outline-emerald-400`},35989:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,65169,23)),Promise.resolve().then(c.bind(c,71281))},51970:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},61135:()=>{},64600:(a,b,c)=>{"use strict";c.d(b,{default:()=>n});var d=c(21124),e=c(38301),f=c(3991),g=c.n(f),h=c(42378),i=c(43249),j=c(32999);let k={customer:"Customer workspace",supplier:"Supplier workspace"},l={customer:"border-emerald-400/40 text-emerald-200 bg-emerald-500/5",supplier:"border-blue-400/40 text-blue-200 bg-blue-500/5"},m={customer:[{label:"Dashboard",href:"/customer"},{label:"Quotes",href:"/customer/quotes"},{label:"Settings",href:"/customer/settings"}],supplier:[{label:"Dashboard",href:"/supplier"},{label:"RFQs",href:"/supplier/rfqs"},{label:"Settings",href:"/supplier/settings"}]};function n({user:a,notifications:b=[],signOutAction:c}){let f=(0,h.usePathname)()??"/",n=(0,e.useMemo)(()=>{var a;return(a=f).startsWith("/customer")?"customer":a.startsWith("/supplier")?"supplier":null},[f]),p=n?m[n]:[];return(0,d.jsx)("header",{className:"sticky top-0 z-40 border-b border-slate-900/70 bg-neutral-950/95 backdrop-blur",children:(0,d.jsxs)("div",{className:"mx-auto flex w-full max-w-page flex-col gap-3 px-4 py-4 sm:px-6 lg:px-8",children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,d.jsxs)(g(),{href:"/",className:"flex items-center gap-3 text-base font-semibold text-ink transition-colors hover:text-ink-soft","aria-label":"Zartman workspace home",children:[(0,d.jsx)("span",{className:"flex h-9 w-9 items-center justify-center rounded-2xl border border-emerald-400/50 bg-emerald-400/10 text-sm font-bold uppercase tracking-wide text-emerald-200",children:"Z"}),(0,d.jsxs)("div",{className:"flex flex-col leading-tight",children:[(0,d.jsx)("span",{children:"Zartman"}),(0,d.jsx)("span",{className:"text-xs font-normal uppercase tracking-[0.35em] text-ink-muted",children:"workspace"})]})]}),a&&n?(0,d.jsx)("span",{className:(0,i.A)("inline-flex items-center rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide",l[n]),children:k[n]}):null]}),(0,d.jsx)("div",{className:"flex items-center gap-3",children:a?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o,{notifications:b}),(0,d.jsx)(r,{user:a,role:n,signOutAction:c})]}):(0,d.jsxs)("div",{className:"flex items-center gap-3 text-sm font-semibold text-ink-soft",children:[(0,d.jsx)(g(),{href:"/login",className:"rounded-full border border-transparent px-4 py-1.5 transition-colors hover:border-slate-800 hover:text-ink",children:"Log in"}),(0,d.jsx)(g(),{href:"/quote",className:j.n4,children:"Get quote"})]})})]}),a&&p.length>0?(0,d.jsx)("nav",{className:"flex flex-wrap items-center gap-2 text-sm font-medium text-slate-400",children:p.map(a=>{var b,c;let e=(b=f)===(c=a.href)||b.startsWith(`${c}/`);return(0,d.jsx)(g(),{href:a.href,className:(0,i.A)("rounded-full px-3 py-1.5 transition-colors",e?"bg-slate-900 text-white":"text-slate-400 hover:text-white"),children:a.label},a.href)})}):null]})})}function o({notifications:a}){let[b,c]=(0,e.useState)(!1),f=(0,e.useRef)(null);(0,h.usePathname)();let g=a.length>0,i=a.filter(a=>!1===a.read).length;return(0,d.jsxs)("div",{className:"relative",ref:f,children:[(0,d.jsxs)("button",{type:"button",onClick:()=>c(a=>!a),className:"relative inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-900/70 bg-slate-950/70 text-slate-300 transition hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-blue-300","aria-haspopup":"menu","aria-expanded":b,"aria-label":g?"View notifications":"No notifications",children:[(0,d.jsx)(q,{className:"h-5 w-5"}),i>0?(0,d.jsx)("span",{className:"absolute -right-0.5 -top-0.5 inline-flex h-2.5 w-2.5 rounded-full bg-sky-400/90 ring-2 ring-slate-950",children:(0,d.jsx)("span",{className:"sr-only",children:`${i} unread notification${1===i?"":"s"}`})}):null]}),b?(0,d.jsxs)("div",{className:"absolute right-0 mt-2 w-80 rounded-2xl border border-slate-900/80 bg-slate-950/95 p-4 text-sm text-slate-200 shadow-[0_18px_40px_rgba(2,6,23,0.65)]",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,d.jsx)("p",{className:"text-sm font-semibold text-white",children:"Notifications"}),(0,d.jsx)("span",{className:"text-xs text-slate-500",children:g?`${i||a.length} new`:"All caught up"})]}),(0,d.jsx)("div",{className:"mt-3 space-y-2",children:g?a.map(a=>(0,d.jsx)(p,{notification:a},a.id)):(0,d.jsx)("p",{className:"text-xs text-slate-500",children:"We’ll surface quote and bid updates here soon."})})]}):null]})}function p({notification:a}){let b=function(a){if("number"!=typeof a||Number.isNaN(a))return null;let b=Date.now()-a;if(b<6e4)return"just now";if(b<36e5){let a=Math.max(1,Math.round(b/6e4));return`${a} minute${1===a?"":"s"} ago`}if(b<864e5){let a=Math.round(b/36e5);return`${a} hour${1===a?"":"s"} ago`}let c=Math.round(b/864e5);return`${c} day${1===c?"":"s"} ago`}(function(a){if(!a)return null;let b=Date.parse(a);return Number.isNaN(b)?null:b}(a.timestamp))??"Just now",c="bid"===a.type?"Bid":"status"===a.type?"Status":"Quote",e=(0,d.jsxs)("div",{className:(0,i.A)("flex flex-col rounded-2xl border px-3 py-2 transition hover:border-blue-400/30 hover:bg-slate-900/40",a.read?"border-slate-900/70 opacity-80":"border-blue-500/30"),children:[(0,d.jsx)("span",{className:(0,i.A)("mb-2 inline-flex w-fit items-center rounded-full border px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide",{Quote:"bg-emerald-500/10 text-emerald-200 border-emerald-500/30",Bid:"bg-blue-500/10 text-blue-200 border-blue-500/30",Status:"bg-slate-500/10 text-slate-200 border-slate-500/30"}[c]??""),children:c}),(0,d.jsx)("p",{className:"text-sm font-semibold text-white",children:a.title}),(0,d.jsx)("p",{className:"text-xs text-slate-400",children:a.description}),(0,d.jsx)("p",{className:"mt-2 text-[11px] uppercase tracking-wide text-slate-500",children:b})]});return a.href?(0,d.jsx)(g(),{href:a.href,className:"block focus-visible:outline focus-visible:outline-2 focus-visible:outline-emerald-300",onClick:a=>a.stopPropagation(),children:e}):e}function q({className:a}){return(0,d.jsxs)("svg",{className:a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,d.jsx)("path",{d:"M12 4a4 4 0 0 0-4 4v2.26c0 .46-.18.9-.5 1.22L6.2 12.78A1 1 0 0 0 6.9 14h10.2a1 1 0 0 0 .7-1.72l-1.3-1.3a1.73 1.73 0 0 1-.5-1.22V8a4 4 0 0 0-4-4Z"}),(0,d.jsx)("path",{d:"M10 17a2 2 0 0 0 4 0"})]})}function r({user:a,role:b,signOutAction:c}){let[f,j]=(0,e.useState)(!1),k=(0,e.useRef)(null);(0,h.usePathname)();let l=a.displayName??a.email??"Signed in user";return(0,d.jsxs)("div",{className:"relative",ref:k,children:[(0,d.jsxs)("button",{type:"button",onClick:()=>j(a=>!a),className:"inline-flex items-center gap-2 rounded-full border border-slate-800 bg-slate-950/50 px-4 py-1.5 text-sm font-semibold text-slate-200 transition hover:border-slate-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-emerald-300","aria-haspopup":"menu","aria-expanded":f,children:[(0,d.jsx)("span",{children:function(a,b=28){return a.length<=b?a:`${a.slice(0,b-3)}...`}(l)}),(0,d.jsx)("svg",{className:(0,i.A)("h-4 w-4 transition-transform",f?"rotate-180":"rotate-0"),viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",children:(0,d.jsx)("path",{d:"M5 7l5 5 5-5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),f?(0,d.jsxs)("div",{className:"absolute right-0 mt-2 w-64 rounded-2xl border border-slate-900 bg-slate-950/95 p-4 text-sm shadow-lg shadow-black/40",children:[(0,d.jsx)("p",{className:"text-xs text-slate-500",children:"Signed in as"}),(0,d.jsx)("p",{className:"mt-1 font-semibold text-white",children:a.displayName??"Workspace user"}),a.email?(0,d.jsx)("p",{className:"text-xs text-slate-500",children:a.email}):null,(0,d.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,d.jsx)(g(),{href:"customer"===b?"/customer/settings":"supplier"===b?"/supplier/settings":"/account/settings",className:"rounded-full border border-slate-800 px-3 py-1.5 text-left text-sm font-semibold text-slate-100 transition hover:border-slate-700 hover:text-white",onClick:()=>j(!1),children:"Account settings"}),(0,d.jsx)("form",{action:c,children:(0,d.jsx)("button",{type:"submit",className:"w-full rounded-full bg-red-500/10 px-3 py-1.5 text-sm font-semibold text-red-200 transition hover:bg-red-500/20",children:"Log out"})})]})]}):null]})}},64811:(a,b,c)=>{"use strict";async function d(a){if(void 0!==a)return await a}function e(a,b){var c;if(!a)return;if(c=a,"function"==typeof c?.get)return a.get(b)??void 0;let d=a[b];return Array.isArray(d)?d[0]:d}function f(a){if(!a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}function g(a){return a?a.startsWith("Q-")?a:`#${a.slice(0,6)}`:"Quote"}function h(a){return Array.isArray(a)?a[0]:a??void 0}c.d(b,{Ol:()=>d,VC:()=>e,nb:()=>h,u_:()=>f,xt:()=>g})},67285:(a,b,c)=>{"use strict";c.d(b,{E:()=>h,Y:()=>g});var d=c(12831),e=c(7633);let f=["id","status","created_at","updated_at","file_name","company","customer_name","email"];async function g(a){let b=a.limit??10,c=await i({customerId:a.customerId??null,email:a.email??null,domain:a.domain??null,limit:Math.max(2*b,20)});if(0===c.length)return[];let d=c.map(a=>a.id),e=await l({quoteIds:d},3*b,!0);return r([...c.map(a=>o(a,"customer")),...c.map(a=>p(a,"customer")).filter(a=>!!a),...e.map(a=>q(a,"customer"))],b)}async function h(a){let b=a.limit??10;if(!a.supplierId&&!a.supplierEmail)return[];let c=t(a.supplierEmail),d=await n(c),e=await l({supplierId:a.supplierId??null},3*b,!1),f=e.map(a=>a.quote_id),g=await j({quoteIds:Array.from(new Set([...d,...f])),supplierEmail:c,limit:Math.max(2*b,20)});return r([...g.map(a=>o(a,"supplier")),...g.map(a=>p(a,"supplier")).filter(a=>!!a),...e.map(a=>q(a,"supplier"))],b)}async function i(a){let{customerId:b,email:c,domain:d,limit:e}=a,f=[];b&&f.push(()=>k(a=>a.eq("customer_id",b).limit(e)));let g=t(c);g&&f.push(()=>k(a=>a.ilike("email",g).limit(e)));let h=function(a){if(!a)return null;let b=a.trim().toLowerCase();return b.length>0?b.replace(/^@/,""):null}(d);for(let a of(h&&f.push(()=>k(a=>a.ilike("email",`%@${h}`).limit(e))),f)){let b=await a();if(b.length>0)return b}return[]}async function j(a){let{quoteIds:b,supplierEmail:c,limit:d}=a;return b.length>0?k(a=>a.in("id",b).limit(d)):c?k(a=>a.or(`assigned_supplier_email.ilike.${c},email.ilike.${c}`).limit(d)):[]}async function k(a){try{let b=d.w9.from("quotes_with_uploads").select(f.join(",")).order("created_at",{ascending:!1}),c=a(b),{data:e,error:g}=await c;if(g)return console.error("activity: quote query failed",{error:g}),[];return e??[]}catch(a){return console.error("activity: quote query error",{error:a}),[]}}async function l(a,b,c){if((!a.quoteIds||0===a.quoteIds.length)&&!a.supplierId)return[];try{let e=d.w9.from("supplier_bids").select("id,quote_id,supplier_id,unit_price,currency,status,lead_time_days,created_at,updated_at").order("updated_at",{ascending:!1}).limit(b);a.quoteIds&&a.quoteIds.length>0&&(e=e.in("quote_id",a.quoteIds)),a.supplierId&&(e=e.eq("supplier_id",a.supplierId));let{data:f,error:g}=await e;if(g)return console.error("activity: bid query failed",{error:g,filter:a}),[];let h=f??[];if(!c||0===h.length)return h;let i=Array.from(new Set(h.map(a=>a.supplier_id).filter(a=>!!a))),j=await m(i),k=new Map(j.map(a=>[a.id,a]));return h.map(a=>({...a,supplier:k.get(a.supplier_id??"")??null}))}catch(b){return console.error("activity: bid query error",{error:b,filter:a}),[]}}async function m(a){if(0===a.length)return[];try{let{data:b,error:c}=await d.w9.from("suppliers").select("id,company_name,primary_email").in("id",a);if(c)return console.error("activity: supplier query failed",{error:c,supplierIds:a}),[];return b??[]}catch(b){return console.error("activity: supplier query error",{error:b,supplierIds:a}),[]}}async function n(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("quote_suppliers").select("quote_id").ilike("supplier_email",a);if(c)return console.error("activity: assignment query failed",{error:c,supplierEmail:a}),[];return(b??[]).map(a=>a.quote_id).filter(a=>!!a)}catch(b){return console.error("activity: assignment query error",{error:b,supplierEmail:a}),[]}}function o(a,b){let c="customer"===b?"/customer/quotes":"/supplier/quotes";return{id:`${b}:quote:${a.id}`,type:"quote",title:`${s(a)} submitted`,description:function(a,b){let c=a.company??a.customer_name??a.email??("customer"===b?"your team":"customer");return"customer"===b?`Uploaded by ${c}`:`RFQ from ${c}`}(a,b),timestamp:u(a.created_at??a.updated_at),href:`${c}/${a.id}`}}function p(a,b){if(!a.updated_at||a.updated_at===a.created_at)return null;let c=(0,e.nu)(a.status??void 0),d=e.LA[c]??"Status update";return{id:`${b}:status:${a.id}:${a.updated_at}`,type:"status",title:`${s(a)} moved to ${d}`,description:"customer"===b?"We updated this RFQ status in your workspace.":"Keep an eye on this RFQ so you can respond quickly.",timestamp:u(a.updated_at),href:`${"customer"===b?"/customer/quotes":"/supplier/quotes"}/${a.id}`}}function q(a,b){let c="customer"===b?"/customer/quotes":"/supplier/quotes",d=function(a){if(!a)return"Pending";let b=a.trim().toLowerCase();return b.charAt(0).toUpperCase()+b.slice(1)}(a.status),e=function(a,b){let c="string"==typeof a?Number(a):a;if("number"!=typeof c||Number.isNaN(c))return"Pricing pending";let d=(b??"USD").toUpperCase();try{return new Intl.NumberFormat("en-US",{style:"currency",currency:d,maximumFractionDigits:0}).format(c)}catch{return`${d} ${c.toFixed(0)}`}}(a.unit_price,a.currency),f="number"==typeof a.lead_time_days&&Number.isFinite(a.lead_time_days)?`${a.lead_time_days} day${1===a.lead_time_days?"":"s"}`:"Lead time pending";if("customer"===b){let b=a.supplier?.company_name??a.supplier?.primary_email??"Supplier partner";return{id:`customer:bid:${a.id}`,type:"bid",title:`${b} submitted a bid`,description:`${d} • ${e} • ${f}`,timestamp:u(a.updated_at??a.created_at),href:`${c}/${a.quote_id}`}}return{id:`supplier:bid:${a.id}`,type:"bid",title:`Bid ${d}`,description:`${e} • ${f}`,timestamp:u(a.updated_at??a.created_at),href:`${c}/${a.quote_id}`}}function r(a,b){let c=new Map;for(let b of a)c.has(b.id)||c.set(b.id,b);return Array.from(c.values()).sort((a,b)=>{let c=Date.parse(a.timestamp)||0;return(Date.parse(b.timestamp)||0)-c}).slice(0,b)}function s(a){return a.file_name?a.file_name:a.company?a.company:`Quote ${a.id.slice(0,6)}`}function t(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}function u(a){return a&&!Number.isNaN(Date.parse(a))?a:new Date().toISOString()}},71281:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspace/src/components/SiteHeader.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/src/components/SiteHeader.tsx","default")},72224:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspace/src/components/AppHeaderClient.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/src/components/AppHeaderClient.tsx","default")},76522:(a,b,c)=>{"use strict";c.d(b,{MB:()=>i,OC:()=>l,qQ:()=>j});var d=c(86802),e=c(82161),f=c(4410);let g="https://qslztdkptpklopyedkfd.supabase.co/",h="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFzbHp0ZGtwdHBrbG9weWVka2ZkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MTYzMzksImV4cCI6MjA3ODk5MjMzOX0.et6RdF18ioinJKYNNTE0UVA5HvRH1YaXmA2DgRHLPWo";if(!g||!h)throw Error("NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY must be set to enable auth.");function i(){return(0,f.createServerClient)(g,h,{cookies:{getAll:async()=>(await (0,d.UL)()).getAll().map(a=>({name:a.name,value:a.value})),async setAll(a){let b=await (0,d.UL)();a.forEach(({name:a,value:c,options:d})=>{b.set({name:a,value:c,...d??{}})})}}})}async function j(){let a=i(),{data:b,error:c}=await a.auth.getSession();return c?(console.error("getCurrentSession: failed to load session",c),null):b.session??null}class k extends Error{constructor(a="Authentication required"){super(a),this.name="UnauthorizedError"}}async function l(a){let b=await j();if(b)return b;throw a?.redirectTo&&(0,e.redirect)(a.redirectTo),new k(a?.message)}},78335:()=>{},84472:(a,b,c)=>{"use strict";c.d(b,{kZ:()=>e});var d=c(12831);async function e(a){if(!a)return null;try{let{data:b,error:c}=await d.w9.from("customers").select("*").eq("user_id",a).maybeSingle();if(c)return console.error("getCustomerByUserId: lookup failed",{userId:a,error:c}),null;return b??null}catch(b){return console.error("getCustomerByUserId: unexpected error",{userId:a,error:b}),null}}},91331:(a,b,c)=>{"use strict";c.d(b,{default:()=>k});var d=c(21124),e=c(3991),f=c.n(e),g=c(42378),h=c(32999);let i=[{label:"Capabilities",href:"/capabilities"},{label:"Resources",href:"/resources"}],j=[{label:"Customer portal",href:"/customer"},{label:"Supplier portal",href:"/supplier"}];function k(){let a=(0,g.usePathname)();return a?.startsWith("/customer")||a?.startsWith("/supplier")?null:(0,d.jsx)("header",{className:"sticky top-0 z-40 border-b border-slate-900/70 bg-neutral-950/90 backdrop-blur-md",children:(0,d.jsxs)("div",{className:"mx-auto grid w-full max-w-page grid-cols-1 gap-4 px-4 py-4 sm:px-6 md:grid-cols-[auto_minmax(0,1fr)_auto] lg:px-8",children:[(0,d.jsxs)(f(),{href:"/",className:"flex items-center gap-3 text-base font-semibold text-ink transition-colors hover:text-ink-soft","aria-label":"Zartman front door",children:[(0,d.jsx)("span",{className:"flex h-9 w-9 items-center justify-center rounded-2xl border border-emerald-400/50 bg-emerald-400/10 text-sm font-bold uppercase tracking-wide text-emerald-200",children:"Z"}),(0,d.jsxs)("div",{className:"flex flex-col leading-tight",children:[(0,d.jsx)("span",{children:"Zartman"}),(0,d.jsx)("span",{className:"text-xs font-normal uppercase tracking-[0.35em] text-ink-muted",children:"marketplace"})]})]}),(0,d.jsx)("nav",{className:"flex flex-wrap items-center justify-center gap-4 text-sm font-medium text-ink-soft md:justify-center",children:i.map(a=>(0,d.jsx)(f(),{href:a.href,className:"transition-colors hover:text-ink",children:a.label},a.href))}),(0,d.jsxs)("div",{className:"flex flex-wrap items-center justify-start gap-3 text-sm font-medium text-ink-soft md:justify-end",children:[j.map(a=>(0,d.jsx)(f(),{href:a.href,className:"rounded-full border border-transparent px-3 py-1.5 transition-colors hover:border-slate-800 hover:text-ink",children:a.label},a.href)),(0,d.jsx)(f(),{href:"/login",className:"rounded-full px-3 py-1.5 text-ink-soft transition-colors hover:text-ink",children:"Log in"}),(0,d.jsx)(f(),{href:"/quote",className:h.n4,children:"Get quote"})]})]})})}},95710:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>k,metadata:()=>j});var d=c(75338);c(61135);var e=c(65169),f=c.n(e);let g=[{title:"Customers",links:[{label:"Customer portal",href:"/customer"},{label:"Become a customer",href:"/customer/signup",description:"Create your workspace and send your first RFQ."}]},{title:"Suppliers",links:[{label:"Supplier portal",href:"/supplier"},{label:"Become a supplier",href:"/supplier/signup",description:"Create a supplier profile and get a magic link to finish onboarding."}]},{title:"Company",links:[{label:"About",href:"/about"},{label:"Contact",href:"/contact"},{label:"Privacy",href:"/privacy"}]}];function h(){return(0,d.jsx)("footer",{className:"border-t border-slate-900/70 bg-neutral-950/90",children:(0,d.jsxs)("div",{className:"mx-auto max-w-page px-4 py-12 sm:px-6 lg:px-8",children:[(0,d.jsx)("div",{className:"grid gap-8 sm:grid-cols-2 md:grid-cols-3",children:g.map(a=>(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("p",{className:"text-sm font-semibold uppercase tracking-wide text-ink",children:a.title}),(0,d.jsx)("ul",{className:"space-y-2 text-sm text-ink-soft",children:a.links.map(a=>(0,d.jsxs)("li",{className:"space-y-1",children:[(0,d.jsx)(f(),{href:a.href,className:"transition-colors hover:text-ink",children:a.label}),a.description?(0,d.jsx)("p",{className:"text-xs text-ink-muted",children:a.description}):null]},a.href))})]},a.title))}),(0,d.jsx)("div",{className:"mt-10 text-xs text-ink-muted",children:"Built for manufacturing teams navigating both customer demand and supplier capacity — one shared cockpit, no duct tape."})]})})}var i=c(71281);let j={title:"Zartman.io",description:"Manufacturing OS — quotes, messaging, suppliers"};function k({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsx)("body",{className:"bg-neutral-950 text-neutral-50 antialiased",children:(0,d.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,d.jsx)(i.default,{}),(0,d.jsx)("div",{className:"flex-1",children:a}),(0,d.jsx)(h,{})]})})})}},96487:()=>{},98351:(a,b,c)=>{"use strict";c.d(b,{D:()=>m,iS:()=>k,g1:()=>l,KP:()=>e,ZS:()=>g,_r:()=>s});var d=c(12831);async function e(a){let b=function(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}(a);if(!b)return null;try{let{data:a,error:c}=await d.w9.from("suppliers").select("*").eq("primary_email",b).maybeSingle();if(c)return console.error("loadSupplierProfile: supplier lookup failed",{email:b,error:c}),null;if(!a)return null;let[e,f]=await Promise.all([i(a.id),j(a.id)]);return{supplier:a,capabilities:e,documents:f}}catch(a){return console.error("loadSupplierProfile: unexpected error",{email:b,error:a}),null}}async function f(a){if(!a)return null;try{let{data:b,error:c}=await d.w9.from("suppliers").select("*").eq("id",a).maybeSingle();if(c)return console.error("loadSupplierById: lookup failed",{supplierId:a,error:c}),null;return b??null}catch(b){return console.error("loadSupplierById: unexpected error",{supplierId:a,error:b}),null}}async function g(a){let b=await h(a);if(!b)return null;let[c,d]=await Promise.all([i(b.id),j(b.id)]);return{supplier:b,capabilities:c,documents:d}}async function h(a){if(!a)return null;try{let{data:b,error:c}=await d.w9.from("suppliers").select("*").eq("user_id",a).maybeSingle();if(c)return console.error("loadSupplierByUserId: lookup failed",{userId:a,error:c}),null;return b??null}catch(b){return console.error("loadSupplierByUserId: unexpected error",{userId:a,error:b}),null}}async function i(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_capabilities").select("*").eq("supplier_id",a).order("created_at",{ascending:!0});if(c)return console.error("listSupplierCapabilities: query failed",{supplierId:a,error:c}),[];return b??[]}catch(b){return console.error("listSupplierCapabilities: unexpected error",{supplierId:a,error:b}),[]}}async function j(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_documents").select("*").eq("supplier_id",a).order("uploaded_at",{ascending:!1});if(c)return console.error("listSupplierDocuments: query failed",{supplierId:a,error:c}),[];return b??[]}catch(b){return console.error("listSupplierDocuments: unexpected error",{supplierId:a,error:b}),[]}}async function k(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_bids").select("*").eq("quote_id",a).order("created_at",{ascending:!1});if(c)return console.error("listSupplierBidsForQuote: query failed",{quoteId:a,error:c}),[];return n(b??[])}catch(b){return console.error("listSupplierBidsForQuote: unexpected error",{quoteId:a,error:b}),[]}}async function l(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_bids").select("*").eq("supplier_id",a).order("updated_at",{ascending:!1});if(c)return console.error("listSupplierBidsForSupplier: query failed",{supplierId:a,error:c}),[];return n(b??[])}catch(b){return console.error("listSupplierBidsForSupplier: unexpected error",{supplierId:a,error:b}),[]}}async function m(a,b){if(!a||!b)return null;try{let{data:c,error:e}=await d.w9.from("supplier_bids").select("*").eq("quote_id",a).eq("supplier_id",b).maybeSingle();if(e)return console.error("getSupplierBidForQuote: lookup failed",{quoteId:a,supplierId:b,error:e}),null;return c??null}catch(c){return console.error("getSupplierBidForQuote: unexpected error",{quoteId:a,supplierId:b,error:c}),null}}async function n(a){if(0===a.length)return[];let b=Array.from(new Set(a.map(a=>a.supplier_id).filter(Boolean))),[c,d]=await Promise.all([o(b),p(b)]),e=new Map;c.forEach(a=>e.set(a.id,a));let f=new Map;return d.forEach(a=>{let b=f.get(a.supplier_id)??[];(a.certifications??[]).filter(a=>"string"==typeof a&&a.trim().length>0).forEach(a=>{b.includes(a)||b.push(a)}),f.set(a.supplier_id,b)}),a.map(a=>({...a,supplier:e.get(a.supplier_id)??null,certifications:f.get(a.supplier_id)??[]}))}async function o(a){if(0===a.length)return[];let{data:b,error:c}=await d.w9.from("suppliers").select("*").in("id",a);return c?(console.error("selectSuppliersByIds: query failed",{supplierIds:a,error:c}),[]):b??[]}async function p(a){if(0===a.length)return[];let{data:b,error:c}=await d.w9.from("supplier_capabilities").select("*").in("supplier_id",a);return c?(console.error("selectCapabilitiesBySupplierIds: query failed",{supplierIds:a,error:c}),[]):b??[]}var q=c(3440);let r=["submitted","in_review","quoted"];async function s(a){let b=await f(a);if(!b)return[];let[c,d,e]=await Promise.all([i(b.id),w(b.primary_email),x(b.id)]),g=function(a){let b=new Set,c=new Set;return a.forEach(a=>{let d=t(a.process);d&&b.add(d),(a.materials??[]).forEach(a=>{let b=function(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}(a);b&&c.add(b)})}),{processes:b,materials:c}}(c);if(0===g.processes.size)return[];let h=new Set;d.forEach(a=>{a?.quote_id&&h.add(a.quote_id)}),e.forEach(a=>{a?.quote_id&&h.add(a.quote_id)});let j=b.verified,k=await u();if(0===k.length)return[];let l=await v(k),m=function(a){let b=0,c=[];a.assignmentCount<=2?(b+=1,c.push("Boosted because this supplier hasn’t been overexposed yet.")):a.assignmentCount>=8&&(b-=.5,c.push("Slight penalty to avoid routing everything to the same shop."));let d=a.recentBidOutcomes.filter(a=>{if(!a.status||"accepted"===a.status)return!1;let b=Date.parse(a.updated_at??"");return!Number.isNaN(b)&&(Date.now()-b)/864e5<=30}).length;return d>0&&(b+=Math.min(1.2,.3*d),c.push("Extra weight because they’ve been responding recently without being selected.")),0===a.recentBidOutcomes.length&&(b+=.4,c.push("New to bidding — giving them a gentle nudge into rotation.")),function(a){if(!a)return!1;let b=Date.parse(a);return!Number.isNaN(b)&&(Date.now()-b)/864e5<=45}(a.supplierCreatedAt)&&(b+=.8,c.push("Recently onboarded supplier gets a temporary boost.")),{modifier:b,reasons:c}}({assignmentCount:d.length,recentBidOutcomes:e,supplierCreatedAt:b.created_at}),n=[];for(let a of k){let b=a.upload_id?l.get(a.upload_id):null,c=b?.manufacturing_process??null,d=t(c);if(!(d&&function(a,b){if(b.has(a))return!0;for(let c of b)if(a.includes(c)||c.includes(a))return!0;return!1}(d,g.processes)))continue;let f=a.id,i=j||!!f&&h.has(f);if(!i)continue;let k=e.find(a=>a.quote_id===f);if(!(0,q.z1)("supplier",{status:a.status,existingBidStatus:k?.status??null,accessGranted:i}))continue;let o=function(a,b){if(!a||0===b.size)return[];let c=[a.notes??"",a.rfq_reason??""].join(" ").toLowerCase(),d=[];return b.forEach(a=>{0!==a.length&&c.includes(a)&&d.push(a)}),d}(b,g.materials),p=function({createdAt:a,materialMatches:b}){let c;if(c=1+.5*b.length,a){let b=Date.parse(a);Number.isNaN(b)||(c+=Math.max(0,30-(Date.now()-b)/864e5)/10)}return c}({createdAt:a.created_at,materialMatches:o})+m.modifier;if(n.push({quoteId:f,quote:a,processHint:c,materialMatches:o,score:p,createdAt:a.created_at??null,quantityHint:b?.quantity??null,fairness:m.reasons.length>0?m:void 0}),n.length>=20)break}return n.sort((a,b)=>b.score-a.score)}function t(a){if("string"!=typeof a)return null;let b=a.trim().toLowerCase();return b.length>0?b:null}async function u(){try{let{data:a,error:b}=await d.w9.from("quotes_with_uploads").select("id,upload_id,customer_name,email,company,status,price,currency,created_at,updated_at,target_date,file_name,assigned_supplier_email,assigned_supplier_name,internal_notes,dfm_notes").in("status",r).order("created_at",{ascending:!1}).limit(50);if(b)return console.error("matchQuotesToSupplier: quote query failed",{error:b}),[];return a??[]}catch(a){return console.error("matchQuotesToSupplier: unexpected quote error",{error:a}),[]}}async function v(a){let b=Array.from(new Set(a.map(a=>a.upload_id).filter(a=>"string"==typeof a&&a.length>0)));if(0===b.length)return new Map;try{let{data:a,error:c}=await d.w9.from("uploads").select("id,manufacturing_process,quantity,rfq_reason,notes").in("id",b);if(c)return console.error("matchQuotesToSupplier: upload query failed",{error:c}),new Map;let e=new Map;return(a??[]).forEach(a=>{a?.id&&e.set(a.id,a)}),e}catch(a){return console.error("matchQuotesToSupplier: unexpected upload error",{error:a}),new Map}}async function w(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("quote_suppliers").select("quote_id").eq("supplier_email",a);if(c)return console.error("matchQuotesToSupplier: assignment query failed",{email:a,error:c}),[];return b??[]}catch(b){return console.error("matchQuotesToSupplier: assignment unexpected error",{email:a,error:b}),[]}}async function x(a){if(!a)return[];try{let{data:b,error:c}=await d.w9.from("supplier_bids").select("quote_id,status,updated_at").eq("supplier_id",a);if(c)return console.error("matchQuotesToSupplier: bid query failed",{supplierId:a,error:c}),[];return b??[]}catch(b){return console.error("matchQuotesToSupplier: bid unexpected error",{supplierId:a,error:b}),[]}}}};