exports.id=7241,exports.ids=[7241],exports.modules={1990:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(75338);function e({className:a}){return(0,d.jsx)("div",{className:`animate-pulse rounded-2xl border border-slate-900/60 bg-slate-800/20 ${a}`})}function f(){return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(e,{className:"h-28"}),(0,d.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:[0,1,2].map(a=>(0,d.jsx)(e,{className:"h-32"},`metric-${a}`))}),[0,1,2].map(a=>(0,d.jsxs)("section",{className:"rounded-2xl border border-slate-900/60 bg-slate-950/60 p-6",children:[(0,d.jsx)("div",{className:"h-4 w-36 animate-pulse rounded bg-slate-800/30"}),(0,d.jsx)("div",{className:"mt-2 h-3 w-64 animate-pulse rounded bg-slate-800/20"}),(0,d.jsx)("div",{className:"mt-5 space-y-2",children:[0,1,2].map(a=>(0,d.jsx)("div",{className:"h-4 w-full animate-pulse rounded bg-slate-800/20"},`line-${a}`))})]},`card-${a}`))]})}},8832:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,65169,23)),Promise.resolve().then(c.bind(c,72224))},15355:(a,b,c)=>{"use strict";c.d(b,{A:()=>f});var d=c(75338),e=c(81171);function f({title:a,description:b,children:c,action:f,className:g}){return(0,d.jsxs)("section",{className:(0,e.A)("rounded-2xl border border-slate-900/70 bg-slate-950/70 px-6 py-5 shadow-[0_10px_30px_rgba(2,6,23,0.45)]",g),children:[(0,d.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-white heading-tight",children:a}),b?(0,d.jsx)("p",{className:"mt-1 text-sm text-slate-400 heading-snug",children:b}):null]}),f?(0,d.jsx)("div",{className:"flex shrink-0 items-center",children:f}):null]}),c?(0,d.jsx)("div",{className:"mt-4 text-sm text-slate-200",children:c}):null]})}},23010:(a,b,c)=>{"use strict";c.d(b,{F:()=>h});var d=c(75338),e=c(81171),f=c(40753);let g={customer:"text-emerald-300",supplier:"text-blue-300"};function h({workspace:a,title:b,subtitle:c,label:h,actions:i,headerContent:j,children:k,className:l,bodyClassName:m}){return(0,d.jsxs)("div",{className:(0,e.A)("space-y-8 lg:space-y-10",l),children:[(0,d.jsx)(f.z,{eyebrow:h??("customer"===a?"Customer workspace":"Supplier workspace"),eyebrowClassName:g[a],title:b,description:c,actions:i,children:j}),(0,d.jsx)("div",{className:(0,e.A)("space-y-8",m),children:k})]})}},40753:(a,b,c)=>{"use strict";c.d(b,{z:()=>f});var d=c(75338),e=c(81171);function f({title:a,description:b,eyebrow:c,eyebrowClassName:f,actions:g,children:h,className:i}){return(0,d.jsxs)("section",{className:(0,e.A)("rounded-3xl border border-slate-900/70 bg-slate-950/70 p-6 shadow-[0_18px_40px_rgba(2,6,23,0.6)]",i),children:[(0,d.jsxs)("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between",children:[(0,d.jsxs)("div",{className:"space-y-3",children:[c?(0,d.jsx)("p",{className:(0,e.A)("text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",f),children:c}):null,(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("h1",{className:"text-3xl font-semibold text-white heading-tight",children:a}),b?(0,d.jsx)("p",{className:"text-sm text-slate-400 heading-snug",children:b}):null]})]}),g?(0,d.jsx)("div",{className:"flex shrink-0 flex-col gap-3 text-sm lg:items-end lg:text-right",children:g}):null]}),h?(0,d.jsx)("div",{className:"mt-6 space-y-4",children:h}):null]})}},42318:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>i});var d=c(75338),e=c(65169),f=c.n(e),g=c(31143),h=c(76522);async function i({children:a}){let{user:b}=await (0,h.Dh)();return(console.log("[customer layout] server session email:",b?.email??null),b)?(0,d.jsx)(g.A,{children:a}):(0,d.jsx)(g.A,{children:(0,d.jsxs)("section",{className:"mx-auto max-w-2xl rounded-3xl border border-slate-900 bg-slate-950/70 p-8 text-center shadow-[0_18px_40px_rgba(2,6,23,0.85)]",children:[(0,d.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-emerald-300",children:"Customer workspace"}),(0,d.jsx)("h1",{className:"mt-4 text-3xl font-semibold text-white",children:"You're not logged in"}),(0,d.jsx)("p",{className:"mt-3 text-sm text-slate-300",children:"Use your work email to request a magic link to your customer workspace. We'll send you right back to this dashboard."}),(0,d.jsx)(f(),{href:"/login?next=/customer",className:"mt-6 inline-flex items-center justify-center rounded-full bg-white/90 px-5 py-2 text-sm font-semibold text-slate-950 transition hover:bg-white",children:"Go to login"})]})})}},68633:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{decryptActionBoundArgs:function(){return s},encryptActionBoundArgs:function(){return r}}),c(77925);let d=c(97954),e=c(27825),f=c(47686),g=c(77533),h=c(63033),i=c(26906),j=function(a){return a&&a.__esModule?a:{default:a}}(c(74515)),k=new TextEncoder,l=new TextDecoder,m=void 0,n=void 0;async function o(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),h=l.decode(await (0,g.decrypt)(c,(0,g.stringToUint8Array)(e),(0,g.stringToUint8Array)(f)));if(!h.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return h.slice(a.length)}async function p(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);h.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,g.arrayBufferToString)(d.buffer),f=await (0,g.encrypt)(c,d,k.encode(a+b));return btoa(e+(0,g.arrayBufferToString)(f))}var q=function(a){return a[a.Ready=0]="Ready",a[a.Pending=1]="Pending",a[a.Complete=2]="Complete",a}(q||{});let r=j.default.cache(async function a(b,...c){let e=h.workUnitAsyncStorage.getStore(),j=e?(0,h.getCacheSignal)(e):void 0,{clientModules:k}=(0,g.getClientReferenceManifestForRsc)(),l=Error();Error.captureStackTrace(l,a);let n=!1,o=e?(0,i.createHangingInputAbortSignal)(e):void 0,q=0;function r(){0===q&&(q=1,null==j||j.beginRead())}function s(){1===q&&(null==j||j.endRead()),q=2}o&&j&&o.addEventListener("abort",r,{once:!0});let t=await (0,f.streamToString)((0,d.renderToReadableStream)(c,k,{filterStackFrame:m,signal:o,onError(a){(null==o||!o.aborted)&&(n||(n=!0,l.message=a instanceof Error?a.message:String(a)))}}),o);if(n)throw s(),l;if(!e)return p(b,t);r();let u=(0,h.getPrerenderResumeDataCache)(e),v=(0,h.getRenderResumeDataCache)(e),w=b+t,x=(null==u?void 0:u.encryptedBoundArgs.get(w))??(null==v?void 0:v.encryptedBoundArgs.get(w));if(x)return x;let y=await p(b,t);return s(),null==u||u.encryptedBoundArgs.set(w,y),y});async function s(a,b){let c,d=await b,f=h.workUnitAsyncStorage.getStore();if(f){let b=(0,h.getCacheSignal)(f),e=(0,h.getPrerenderResumeDataCache)(f),g=(0,h.getRenderResumeDataCache)(f);(c=(null==e?void 0:e.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await o(a,d),null==b||b.endRead(),null==e||e.decryptedBoundArgs.set(d,c))}else c=await o(a,d);let{edgeRscModuleMapping:i,rscModuleMapping:j}=(0,g.getClientReferenceManifestForRsc)();return await (0,e.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(k.encode(c)),null==f?void 0:f.type){case"prerender":case"prerender-runtime":f.renderSignal.aborted?a.close():f.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:n,serverConsumerManifest:{moduleLoading:null,moduleMap:j,serverModuleMap:(0,g.getServerModuleMap)()}})}},72384:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,3991,23)),Promise.resolve().then(c.bind(c,64600))},75879:(a,b,c)=>{"use strict";Object.defineProperty(b,"A",{enumerable:!0,get:function(){return d.registerServerReference}});let d=c(97954)},81171:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=function(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}},83287:(a,b,c)=>{"use strict";c.d(b,{QH:()=>k,rA:()=>i});var d=c(12831),e=c(84472),f=c(64811),g=c(33358),h=c(81518);async function i(a,b){var c,d,i;console.info("[customer activity] load start",{customerId:a,emailOverride:b?.emailOverride??null});let k=(0,f.u_)(b?.emailOverride??null);if(!a&&!k)return[];let p=[];if(k)p=await j(k,{customerId:a,scope:"override"});else{let b=await (0,e.rC)(a);if(!b)return[];let c=(0,f.u_)(b.email??null);if(!c)return[];p=await j(c,{customerId:b.id,scope:"customer"})}if(console.info("[customer activity] quotes resolved",{customerId:a,quoteCount:p.length}),0===p.length)return[];let q=new Map(p.map(a=>[a.id,a])),r=Array.from(q.keys()),[s,t]=await Promise.all([l(r),m(r)]),u=function(a){let b=new Map;for(let c of a)"string"==typeof c.status&&"won"===c.status.toLowerCase()&&b.set(c.quote_id,c);return b}(t),v=[];for(let a of p){v.push((c=a,{id:`quote:${c.id}:submitted`,quoteId:c.id,type:"rfq_submitted",title:`${n(c)} submitted`,description:c.company?`Uploaded by ${c.company}`:"New RFQ synced to your workspace.",timestamp:o(c.created_at??c.updated_at),href:`/customer/quotes/${c.id}`}));let b=function(a){if(!a.updated_at||a.updated_at===a.created_at)return null;let b=(0,g.Ao)(a.status??void 0),c=(0,g.RH)(b);return{id:`quote:${a.id}:status:${a.updated_at}`,quoteId:a.id,type:"status_changed",title:`${n(a)} marked ${c}`,description:"We updated this RFQ status so your team stays aligned.",timestamp:o(a.updated_at),href:`/customer/quotes/${a.id}`}}(a);b&&v.push(b);let d=function(a,b){if(!b&&"won"!==(a.status??"").toLowerCase())return null;let c=b?.unit_price??a.price,d=b?.currency??a.currency,e="number"==typeof c||"string"==typeof c?(0,h.v)("string"==typeof c?Number(c):c??null,d):"Price pending";return{id:`winner:${a.id}:${a.updated_at??a.created_at??"latest"}`,quoteId:a.id,type:"winner_selected",title:`Winning supplier selected for ${n(a)}`,description:`${e} • Quote marked as won`,timestamp:o(a.updated_at??new Date().toISOString()),href:`/customer/quotes/${a.id}`}}(a,u.get(a.id));d&&v.push(d)}for(let a of s){let b=q.get(a.quote_id);b&&"customer"!==a.author_type&&v.push(function(a,b){var c,d;return{id:`message:${a.id}`,quoteId:b.id,type:"message_posted",title:`${a.author_name??"A teammate"} replied on ${n(b)}`,description:(c=a.body,d=180,c?c.length<=180?c:`${c.slice(0,d-1)}…`:""),actor:a.author_name??a.author_type,timestamp:o(a.created_at),href:`/customer/quotes/${b.id}`}}(a,b))}for(let a of t){let b=q.get(a.quote_id);b&&v.push((d=a,i=b,{id:`bid:${d.id}`,quoteId:i.id,type:"bid_received",title:`Supplier bid updated on ${n(i)}`,description:function(a){let b="string"==typeof a.unit_price?Number(a.unit_price):a.unit_price??null,c=(0,h.v)("number"==typeof b?b:null,a.currency??"USD"),d="number"==typeof a.lead_time_days?`${a.lead_time_days} day${1===a.lead_time_days?"":"s"}`:"Lead time pending";return`${c} • ${d}`}(d),timestamp:o(d.updated_at??d.created_at),href:`/customer/quotes/${i.id}`}))}let w=function(a){let b=new Map;for(let c of a)b.has(c.id)||b.set(c.id,c);return Array.from(b.values()).sort((a,b)=>{let c=Date.parse(a.timestamp)||0;return(Date.parse(b.timestamp)||0)-c}).slice(0,10)}(v);return console.info("[customer activity] events built",{customerId:a,eventCount:w.length}),w}async function j(a,b){let c=(0,f.u_)(a??null);if(!c)return[];let e=b?.limit??30,{data:g,error:h}=await d.w9.from("quotes_with_uploads").select("id,file_name,company,customer_name,email,status,created_at,updated_at,price,currency").order("updated_at",{ascending:!1}).limit(e).ilike("email",c);return h?(console.error(b?.scope==="override"?"[customer activity] override query failed":"[customer activity] quote query failed",{customerId:b?.customerId??null,email:c,error:h}),[]):g??[]}async function k(a,b){console.info("[customer quotes] load start",{customerId:a,hasOverride:!!b?.emailOverride});let c=(0,f.u_)(b?.emailOverride??null),d=b?.limit??100,g=c;if(!g){let b=await (0,e.rC)(a);if(!b)return console.warn("[customer quotes] no customer found for id",{customerId:a}),[];let c=(0,f.u_)(b.email??null);if(!c)return console.warn("[customer quotes] customer email missing/invalid",{customerId:a,rawEmail:b.email??null}),[];g=c}let h=await j(g,{customerId:a,scope:c?"override":"customer",limit:d});return console.info("[customer quotes] load result",{customerId:a,email:g,quoteCount:h.length}),h}async function l(a){if(0===a.length)return[];let{data:b,error:c}=await d.w9.from("quote_messages").select("id,quote_id,author_type,author_name,body,created_at").in("quote_id",a).order("created_at",{ascending:!1}).limit(40);return c?(console.error("[customer activity] message query failed",{error:c}),[]):b??[]}async function m(a){if(0===a.length)return[];let{data:b,error:c}=await d.w9.from("supplier_bids").select("id,quote_id,unit_price,currency,lead_time_days,status,created_at,updated_at").in("quote_id",a).order("updated_at",{ascending:!1}).limit(30);return c?(console.error("[customer activity] bid query failed",{error:c}),[]):b??[]}function n(a){return a.file_name??a.company??`Quote ${a.id.slice(0,6)}`}function o(a){return a&&!Number.isNaN(Date.parse(a))?a:new Date().toISOString()}},85804:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"009ccb7b9407a544cd2cae6819b25555f3009b4a2c":()=>d.x});var d=c(9736)}};