exports.id=629,exports.ids=[629],exports.modules={7633:(a,b,c)=>{"use strict";c.d(b,{$p:()=>i,LA:()=>j,Zo:()=>f,mh:()=>k,mj:()=>g,nu:()=>h});let d=["submitted","in_review","quoted","approved","rejected"],e={new:"submitted",on_hold:"in_review",closed_lost:"rejected",draft:"submitted"},f="submitted";function g(a){return"string"==typeof a&&d.includes(a)}function h(a,b=f){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(e[b])return e[b]}return b}function i(a){if(g(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(g(b))return b}return null}let j={submitted:"Submitted",in_review:"In review",quoted:"Quoted",approved:"Approved",rejected:"Rejected"},k=[...d]},11802:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},12831:(a,b,c)=>{"use strict";c.d(b,{E2:()=>i,qr:()=>h,w9:()=>j});var d=c(36464);let e=process.env.SUPABASE_URL??process.env.NEXT_PUBLIC_SUPABASE_URL,f=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,g=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e)throw Error("SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL is required (check your env vars).");let h=()=>{if(!f)throw Error("NEXT_PUBLIC_SUPABASE_ANON_KEY is required");return(0,d.UU)(e,f,{auth:{persistSession:!1}})},i=()=>{if(!g)throw Error("SUPABASE_SERVICE_ROLE_KEY is required");return(0,d.UU)(e,g,{auth:{persistSession:!1}})},j=i()},15966:(a,b,c)=>{Promise.resolve().then(c.bind(c,62720))},26276:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"40d01a0d46d9ebe487c81f53b676bcf4edf2798212":()=>q,"602809d184fae8c64cc73392e815fc22e9da1ae5b2":()=>r,"60a59389cf62986ca3560f824ad12c13927508374d":()=>t});var d=c(91488);c(27806);var e=c(44338),f=c(91837),g=c(69206),h=c(27982);let i=process.env.SUPABASE_URL??process.env.NEXT_PUBLIC_SUPABASE_URL;process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;let j=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!i)throw Error("SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL is required (check your env vars).");let k=(()=>{if(!j)throw Error("SUPABASE_SERVICE_ROLE_KEY is required");return(0,h.UU)(i,j,{auth:{persistSession:!1}})})(),l=["submitted","in_review","quoted","approved","rejected"],m={new:"submitted",on_hold:"in_review",closed_lost:"rejected",draft:"submitted"},n="submitted";function o(a){return"string"==typeof a&&l.includes(a)}function p(a,b=n){if(o(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(m[b])return m[b]}return b}async function q(a){let b=a.get("id"),c=function(a){if(o(a))return a;if("string"==typeof a){let b=a.trim().toLowerCase();if(o(b))return b}return null}(a.get("status"))??n,d=a.get("price"),e=a.get("currency"),h=a.get("target_date"),i=a.get("internal_notes"),j=a.get("dfm_notes"),l=d&&d.length>0?parseFloat(d):null,{data:m,error:p}=await k.from("quotes").update({status:c,price:l,currency:e,target_date:h||null,internal_notes:i||null,dfm_notes:"string"==typeof j&&j.trim().length>0?j:null,updated_at:new Date().toISOString()}).eq("id",b).select("upload_id").maybeSingle();if(p)throw console.error("Quote update error",p),Error("Failed to update quote.");if(m?.upload_id){let{error:a}=await k.from("uploads").update({status:c,quote_id:b}).eq("id",m.upload_id);a?console.error("Failed to sync upload status with quote",a):(0,f.revalidatePath)(`/admin/uploads/${m.upload_id}`)}return(0,f.revalidatePath)("/admin"),(0,g.redirect)(`/admin/quotes/${b}?updated=1`)}async function r(a,b){try{return await q(b),{}}catch(a){if((0,e.isRedirectError)(a))throw a;return console.error("handleQuoteFormSubmit error",a),{error:"Failed to save changes. Please try again."}}}async function s(a,b,c){let{error:d}=await k.from("uploads").update({quote_id:b,status:c}).eq("id",a);return!d||(console.error("Failed to sync upload.quote_id after quote creation",d),!1)}async function t(a,b){let c=b.get("upload_id");if("string"!=typeof c||0===c.trim().length)return{error:"Missing upload ID, please refresh and try again."};let d=c.trim();try{let{data:a,error:b}=await k.from("uploads").select("id, quote_id, customer_id, status").eq("id",d).maybeSingle();if(b||!a)return console.error("createQuoteFromUpload: upload lookup failed",b),{error:"Could not create quote, please try again."};if(a.quote_id)return(0,f.revalidatePath)("/admin"),(0,f.revalidatePath)(`/admin/uploads/${d}`),(0,g.redirect)(`/admin/quotes/${a.quote_id}`);let c=p(a.status,n),{data:e,error:h}=await k.from("quotes").select("id,status").eq("upload_id",d).maybeSingle();if(h&&console.error("createQuoteFromUpload: existing quote lookup failed",h),e?.id){let a=p(e.status,c);if(!await s(d,e.id,a))return{error:"Found an existing quote, but linking it to the upload failed. Please retry."};return(0,f.revalidatePath)("/admin"),(0,f.revalidatePath)(`/admin/uploads/${d}`),(0,g.redirect)(`/admin/quotes/${e.id}`)}let{data:i,error:j}=await k.from("quotes").insert({upload_id:d,customer_id:a.customer_id??null,status:c,currency:"USD",internal_notes:`Created from upload ${d}`}).select("id").single();if(j||!i)return console.error("createQuoteFromUpload: insert failed",j),{error:"Could not create quote, please try again."};if(!await s(d,i.id,c))return{error:"Quote was created, but we could not update the upload. Click again to retry."};return(0,f.revalidatePath)("/admin"),(0,f.revalidatePath)(`/admin/uploads/${d}`),(0,g.redirect)(`/admin/quotes/${i.id}`)}catch(a){if((0,e.isRedirectError)(a))throw a;return console.error("createQuoteFromUpload: unexpected error",a),{error:"Could not create quote, please try again."}}}[...l],(0,c(40410).D)([q,r,t]),(0,d.A)(q,"40d01a0d46d9ebe487c81f53b676bcf4edf2798212",null),(0,d.A)(r,"602809d184fae8c64cc73392e815fc22e9da1ae5b2",null),(0,d.A)(t,"60a59389cf62986ca3560f824ad12c13927508374d",null)},32999:(a,b,c)=>{"use strict";c.d(b,{n:()=>d});let d="inline-flex items-center justify-center rounded-full bg-emerald-400 px-5 py-2 text-sm font-semibold text-slate-950 shadow-lift-sm transition-colors hover:bg-emerald-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-300 disabled:cursor-not-allowed disabled:opacity-60"},34903:(a,b,c)=>{"use strict";c.d(b,{default:()=>k});var d=c(21124),e=c(43249),f=c(23312),g=c(85708);let h=(0,g.createServerReference)("60a59389cf62986ca3560f824ad12c13927508374d",g.callServer,void 0,g.findSourceMapURL,"createQuoteFromUploadAction");var i=c(32999);let j={};function k({uploadId:a,label:b="Create quote",size:c="md",align:g="start",className:i}){let[k,m]=(0,f.useFormState)(h,j);return(0,d.jsxs)("form",{action:m,className:(0,e.A)("flex flex-col gap-1","end"===g?"items-end text-right":"center"===g?"items-center text-center":"items-start text-left",i),children:[(0,d.jsx)("input",{type:"hidden",name:"upload_id",value:a}),(0,d.jsx)(l,{label:b,size:c}),k?.error&&(0,d.jsx)("p",{className:(0,e.A)("text-xs text-red-400","end"===g?"text-right":"center"===g?"text-center":"text-left"),children:k.error})]})}function l({label:a,size:b}){let{pending:c}=(0,f.useFormStatus)();return(0,d.jsx)("button",{type:"submit",disabled:c,className:(0,e.A)(i.n,"sm"===b?"px-4 py-1.5 text-xs":""),children:c?"Creating...":a})}},43249:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=function(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f,metadata:()=>e});var d=c(75338);c(61135);let e={title:"Zartman.io",description:"Manufacturing OS â€” quotes, messaging, suppliers"};function f({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsx)("body",{children:a})})}},51970:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},60029:()=>{},61135:()=>{},62720:(a,b,c)=>{"use strict";c.d(b,{default:()=>h});var d=c(21124),e=c(3991),f=c.n(e),g=c(42378);function h(){let a=(0,g.usePathname)(),b="/admin"===a||a.startsWith("/admin/uploads"),c=a.startsWith("/admin/quotes"),e="px-4 py-2 rounded-full text-sm font-medium transition",h="bg-emerald-500 text-slate-900",i="text-emerald-400 border border-emerald-600 hover:bg-emerald-900";return(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(f(),{href:"/admin",className:`${e} ${b?h:i}`,children:"Uploads"}),(0,d.jsx)(f(),{href:"/admin/quotes",className:`${e} ${c?h:i}`,children:"Quotes"})]})}},69110:(a,b,c)=>{Promise.resolve().then(c.bind(c,75502))},75502:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspace/src/app/admin/AdminNav.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/src/app/admin/AdminNav.tsx","default")},87645:()=>{},93972:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(75338),e=c(75502);function f({children:a}){return(0,d.jsxs)("div",{className:"min-h-screen bg-slate-950 text-slate-50",children:[(0,d.jsx)("header",{className:"border-b border-slate-800",children:(0,d.jsxs)("div",{className:"mx-auto max-w-5xl px-4 py-4 flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"text-sm font-semibold tracking-tight",children:["zartman.io ",(0,d.jsx)("span",{className:"text-slate-400",children:"admin"})]}),(0,d.jsx)(e.default,{})]})}),a]})}},95668:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspace/src/app/admin/CreateQuoteButton.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/src/app/admin/CreateQuoteButton.tsx","default")}};