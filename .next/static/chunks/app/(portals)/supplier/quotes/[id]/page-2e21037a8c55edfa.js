(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{63:(e,t,l)=>{"use strict";var a=l(7260);l.o(a,"usePathname")&&l.d(t,{usePathname:function(){return a.usePathname}}),l.o(a,"useRouter")&&l.d(t,{useRouter:function(){return a.useRouter}}),l.o(a,"useSearchParams")&&l.d(t,{useSearchParams:function(){return a.useSearchParams}})},2430:(e,t,l)=>{"use strict";l.d(t,{SupplierBidPanel:()=>m});var a=l(5155),s=l(2115),r=l(7650),n=l(926);let i=(0,n.createServerReference)("60da38e18e227a6d4337b581a11ca016ec9551fd78",n.callServer,void 0,n.findSourceMapURL,"submitSupplierBidAction");var o=l(7275),c=l(8799),d=l(7344);let u={ok:!0,message:""};function m(e){var t,l,n,o,m,b;let{quoteId:f,initialBid:h,approvalsOn:g,approved:y,bidsUnavailableMessage:v}=e,j=(0,s.useRef)(null),[k,N]=(0,s.useState)(!1),[w,S]=(0,r.useFormState)(i,u),_=(0,s.useMemo)(()=>(function(e){var t,l;if(!e)return{ok:!0,message:""};if(e.ok){return{ok:!0,message:null!=(t=e.message)?t:""}}return{ok:!1,error:e.error||"We couldn't submit your bid. Please try again.",fieldErrors:(l=e.fieldErrors)&&"object"==typeof l?Object.entries(l).reduce((e,t)=>{let[l,a]=t;return"string"==typeof a&&a.length>0&&(e[l]=a),e},{}):{}}})(w),[w]),P=(0,s.useMemo)(()=>(function(e){var t;if(!e)return"";let l="number"==typeof e.amount?(0,d.v)(e.amount,e.currency,{maximumFractionDigits:2}):null,a=l&&"—"!==l?l:null,s=null!=(t=e.updated_at)?t:e.created_at,r=s?(0,c.r)(s):null;return a&&r?"".concat(a," bid on file (submitted ").concat(r,"). Update it anytime."):a?"".concat(a," bid on file. Update it anytime."):r?"Bid submitted ".concat(r,". Update it anytime."):"Your latest bid is on file. Update it anytime."})(h),[h]),U=k&&_.ok&&!!_.message,C=!k&&!!h,E=U?_.message:C?P:"";(0,s.useEffect)(()=>{if(U){var e;null==(e=j.current)||e.reset()}},[U]);let L=g&&!y||!!v,q=h?"Update bid":"Submit bid",M=null!=(l=null!=(t=null==h?void 0:h.updated_at)?t:null==h?void 0:h.created_at)?l:null;return(0,a.jsxs)("div",{className:"space-y-4",children:[g&&!y?(0,a.jsx)("p",{className:"rounded-xl border border-yellow-500/30 bg-yellow-500/5 px-3 py-2 text-xs text-yellow-100",children:"Your profile is pending review. You can edit your profile, but bids will open up once you’re approved."}):null,v?(0,a.jsx)("p",{className:"rounded-xl border border-slate-800 bg-black/40 px-3 py-2 text-xs text-slate-300",children:v}):null,(0,a.jsxs)("form",{ref:j,action:e=>{var t;return N(!0),e.set("amount","string"!=typeof(t=e.get("amount"))?"":t.trim().replace(/[,\s]/g,"")),S(e)},className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"quoteId",value:f}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(p,{label:"Amount",name:"amount",type:"text",inputMode:"decimal",placeholder:"15000",defaultValue:null!=(n=null==h?void 0:h.amount)?n:void 0,disabled:L,prefix:"$",autoComplete:"off",error:k&&!_.ok?_.fieldErrors.amount:void 0}),(0,a.jsx)(p,{label:"Currency",name:"currency",placeholder:"USD",defaultValue:null!=(o=null==h?void 0:h.currency)?o:"USD",disabled:L}),(0,a.jsx)(p,{label:"Lead time (days)",name:"leadTimeDays",type:"number",placeholder:"14",defaultValue:"number"==typeof(null==h?void 0:h.lead_time_days)?h.lead_time_days:void 0,disabled:L,error:k&&!_.ok?_.fieldErrors.leadTimeDays:void 0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Notes & certifications"}),(0,a.jsx)("textarea",{name:"notes",defaultValue:null!=(m=null==h?void 0:h.notes)?m:"",rows:4,disabled:L,className:"mt-1 w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-400 focus:outline-none disabled:opacity-60",placeholder:"Call out certifications, MOQ, inspection plans, or anything the customer should know."})]}),k&&!_.ok?(0,a.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:_.error}):null,(U||C)&&E?(0,a.jsx)("p",{className:"text-sm text-emerald-300",role:"status",children:E}):null,(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsx)(x,{label:q,disabled:L}),(null==h?void 0:h.status)?(0,a.jsxs)("span",{className:"inline-flex rounded-full border border-slate-800 bg-slate-900/60 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-slate-300",children:["Status: ",(null!=(b=h.status)?b:"submitted").toString()]}):null]})]}),h?(0,a.jsxs)("div",{className:"rounded-xl border border-slate-900/60 bg-slate-950/30 px-4 py-3 text-sm text-slate-200",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Last submitted"}),(0,a.jsxs)("dl",{className:"mt-2 grid gap-3 sm:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Amount"}),(0,a.jsx)("dd",{className:"font-medium text-slate-100",children:"number"==typeof h.amount?(0,d.v)(h.amount,h.currency):"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Lead time"}),(0,a.jsx)("dd",{className:"font-medium text-slate-100",children:"number"==typeof h.lead_time_days?"".concat(h.lead_time_days," day").concat(1===h.lead_time_days?"":"s"):"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Submitted"}),(0,a.jsx)("dd",{className:"font-medium text-slate-100",children:M?(0,c.r)(M):"—"})]})]}),h.notes?(0,a.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:h.notes}):null]}):null]})}function p(e){let{label:t,name:l,type:s="text",placeholder:r,defaultValue:n,disabled:i,step:o,prefix:c,error:d,inputMode:u,autoComplete:m}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:t}),(0,a.jsxs)("div",{className:"mt-1 flex items-center rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus-within:border-blue-400",children:[c?(0,a.jsx)("span",{className:"mr-1 text-slate-500",children:c}):null,(0,a.jsx)("input",{type:s,name:l,placeholder:r,defaultValue:n,disabled:i,step:o,inputMode:u,autoComplete:m,className:"w-full bg-transparent text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none disabled:opacity-60"})]}),d?(0,a.jsx)("p",{className:"mt-1 text-xs text-red-300",role:"alert",children:d}):null]})}function x(e){let{label:t,disabled:l}=e,{pending:s}=(0,r.useFormStatus)();return(0,a.jsx)("button",{type:"submit",disabled:s||l,className:"".concat(o.n4," ").concat(o.m.md," ").concat(s||l?"opacity-60":""),children:s?"Saving...":t})}},2869:(e,t,l)=>{"use strict";l.d(t,{PortalLoginPanel:()=>c});var a=l(5155),s=l(2115),r=l(63),n=l(926);let i=(0,n.createServerReference)("406e181b0a5d2b06f6acc70058cbb130f480225e5c",n.callServer,void 0,n.findSourceMapURL,"requestMagicLinkForEmail"),o={customer:{title:"Customer workspace",description:"Use your work email and we’ll send you a magic link to your workspace.",accent:"text-emerald-300",cta:"Email me a link"},supplier:{title:"Supplier workspace",description:"Use the email you onboarded with and we’ll send you a magic link.",accent:"text-blue-300",cta:"Send magic link"}};function c(e){let{role:t,fallbackRedirect:l,nextPath:n}=e,[c,d]=(0,s.useState)(""),[u,m]=(0,s.useState)("idle"),[p,x]=(0,s.useState)(null),[b,f]=(0,s.useState)(null),h=(0,r.usePathname)(),g=Object.prototype.hasOwnProperty.call(o,t);g||console.warn("[portal-login] unknown role received, defaulting to customer",{role:t});let y=g?t:"customer",v="string"==typeof n&&n.startsWith("/")?n:null,j=null!=v?v:"string"==typeof h&&h.startsWith("/".concat(y))?h:l,k=!!v&&("/quote"===v||v.startsWith("/quote"));async function N(e){e.preventDefault();let t=c.trim().toLowerCase();if(!t||!t.includes("@")){x("supplier"===y?"Enter a business email that matches your onboarding profile.":"Enter a valid work email."),m("error");return}try{var l,a;m("sending"),x(null);let e=await i({role:y,email:t,nextPath:j});if(!e.success){m("error"),x(null!=(l=e.error)?l:"supplier"===y?"We couldn’t send the link. Check your connection and try again.":"We couldn’t send the link. Try again in a few seconds.");return}m("sent"),f(null!=(a=e.normalizedEmail)?a:t)}catch(e){console.error("Portal login: failed to request magic link",e),x("supplier"===y?"We couldn’t send the link. Check your connection and try again.":"We couldn’t send the link. Try again in a few seconds."),m("error")}}(0,s.useEffect)(()=>{k&&console.log("[login] rendering quote-flow login",{nextPath:v})},[k,v]);let w=o[y],S=k?{...w,title:"Log in to request a quote",description:"Use your work email and we'll send you a magic link to your customer workspace.",cta:"Send magic link"}:w;return(0,a.jsxs)("section",{className:"mx-auto max-w-lg rounded-2xl border border-slate-900 bg-slate-950/50 p-6",children:[(0,a.jsxs)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] ".concat(S.accent),children:[y," portal"]}),(0,a.jsx)("h2",{className:"mt-2 text-xl font-semibold text-white",children:S.title}),(0,a.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:S.description}),(0,a.jsxs)("form",{onSubmit:N,className:"mt-5 space-y-3",children:[(0,a.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Work email"}),(0,a.jsx)("input",{type:"email",value:c,onChange:e=>d(e.target.value),className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-white focus:outline-none",placeholder:"you@company.com",required:!0}),(0,a.jsx)("button",{type:"submit",disabled:"sending"===u,className:"w-full rounded-full border border-slate-800 bg-white/90 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:bg-white disabled:opacity-60",children:"sending"===u?"Sending...":S.cta}),"sent"===u?(0,a.jsx)("p",{className:"text-sm text-emerald-200",children:"supplier"===y?(0,a.jsxs)(a.Fragment,{children:["Link sent to"," ",(0,a.jsx)("span",{className:"font-mono text-white",children:null!=b?b:c.trim().toLowerCase()})," ","– check your inbox."]}):"Check your inbox for the magic link."}):null,p?(0,a.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:p}):null,(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["You’ll land back on ",(0,a.jsx)("span",{className:"font-mono text-slate-300",children:j})," after clicking the link."]})]})]})}},6206:(e,t,l)=>{"use strict";l.d(t,{SupplierQuoteMessageComposer:()=>d});var a=l(5155),s=l(2115),r=l(7650),n=l(926);let i=(0,n.createServerReference)("6033c8b2ad06a241a65d609e3a5185e159405192fa",n.callServer,void 0,n.findSourceMapURL,"postSupplierQuoteMessageAction");var o=l(7275);let c={success:!1,error:null};function d(e){let{quoteId:t,supplierEmail:l,disabled:n=!1}=e,o=(0,s.useRef)(null),d=(0,s.useRef)(null),[m,p]=(0,r.useFormState)(i,c);return(0,s.useEffect)(()=>{var e;m.success&&(null==(e=o.current)||e.reset(),d.current&&(d.current.value=""))},[m.success,m.messageId]),(0,a.jsxs)("form",{ref:o,action:p,className:"space-y-3",children:[(0,a.jsx)("input",{type:"hidden",name:"quote_id",value:t}),(0,a.jsx)("input",{type:"hidden",name:"identity_email",value:l}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{htmlFor:"supplier-quote-message-body",className:"text-sm font-medium text-slate-200",children:"Message"}),(0,a.jsx)("textarea",{id:"supplier-quote-message-body",name:"body",ref:d,rows:4,maxLength:2e3,disabled:n,className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-400 focus:outline-none disabled:opacity-60",placeholder:"Share build progress, questions, or risks with the Zartman team..."})]}),m.error&&(0,a.jsx)("p",{className:"text-sm text-red-400",role:"alert","aria-live":"polite",children:m.error}),(0,a.jsx)(u,{disabled:n})]})}function u(e){let{disabled:t}=e,{pending:l}=(0,r.useFormStatus)();return(0,a.jsx)("button",{type:"submit",disabled:l||t,className:"".concat(o.n4," ").concat(o.m.md," w-full sm:w-auto"),children:l?"Sending...":"Send update"})}},7344:(e,t,l)=>{"use strict";function a(e,t,l){var a,s;if("number"!=typeof e||Number.isNaN(e))return"—";let r=(null!=t?t:"USD").toUpperCase(),n=null!=(a=null==l?void 0:l.maximumFractionDigits)?a:0,i=null!=(s=null==l?void 0:l.minimumFractionDigits)?s:n;try{return new Intl.NumberFormat("en-US",{style:"currency",currency:r,minimumFractionDigits:i,maximumFractionDigits:n}).format(e)}catch(l){let t=Math.max(i,n);return"".concat(r," ").concat(e.toFixed(t))}}l.d(t,{v:()=>a})},8799:(e,t,l)=>{"use strict";l.d(t,{l:()=>n,r:()=>r});let a="en-US";function s(e){if(null==e)return null;let t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?null:t}function r(e){let{includeTime:t=!1,fallback:l="—"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s(e);if(!r)return l;let n=r.toLocaleDateString(a,{month:"short",day:"numeric",year:"numeric"});if(!t)return n;let i=r.toLocaleTimeString(a,{hour:"numeric",minute:"2-digit"});return"".concat(n," \xb7 ").concat(i)}function n(e){let t=s(e);return t?t.toISOString().slice(0,10):""}},8894:(e,t,l)=>{Promise.resolve().then(l.bind(l,2869)),Promise.resolve().then(l.bind(l,2430)),Promise.resolve().then(l.bind(l,6206)),Promise.resolve().then(l.bind(l,8567)),Promise.resolve().then(l.bind(l,9867))}},e=>{e.O(0,[264,441,255,358],()=>e(e.s=8894)),_N_E=e.O()}]);