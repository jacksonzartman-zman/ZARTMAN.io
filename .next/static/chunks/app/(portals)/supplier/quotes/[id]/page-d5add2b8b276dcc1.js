(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3214],{63:(e,t,s)=>{"use strict";var l=s(7260);s.o(l,"usePathname")&&s.d(t,{usePathname:function(){return l.usePathname}}),s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}}),s.o(l,"useSearchParams")&&s.d(t,{useSearchParams:function(){return l.useSearchParams}})},2372:(e,t,s)=>{"use strict";s.d(t,{PortalLoginPanel:()=>d});var l=s(5155),a=s(2115),r=s(63),n=s(926);let i=(0,n.createServerReference)("4053d7be6d97a15511460569746e55474327dbacfc",n.callServer,void 0,n.findSourceMapURL,"requestMagicLinkForEmail"),o={customer:{title:"Customer workspace",description:"Use your work email and we’ll send you a magic link to your workspace.",accent:"text-emerald-300",cta:"Email me a link"},supplier:{title:"Supplier workspace",description:"Use the email you onboarded with and we’ll send you a magic link.",accent:"text-blue-300",cta:"Send magic link"}};function d(e){let{role:t,fallbackRedirect:s,nextPath:n}=e,[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)("idle"),[x,p]=(0,a.useState)(null),[b,h]=(0,a.useState)(null),f=(0,r.usePathname)(),g=Object.prototype.hasOwnProperty.call(o,t);g||console.warn("[portal-login] unknown role received, defaulting to customer",{role:t});let y=g?t:"customer",j="string"==typeof n&&n.startsWith("/")?n:null,N=null!=j?j:"string"==typeof f&&f.startsWith("/".concat(y))?f:s,w=!!j&&("/quote"===j||j.startsWith("/quote"));async function v(e){e.preventDefault();let t=d.trim().toLowerCase();if(!t||!t.includes("@")){p("supplier"===y?"Enter a business email that matches your onboarding profile.":"Enter a valid work email."),m("error");return}try{var s,l;m("sending"),p(null);let e=await i({role:y,email:t,nextPath:N});if(!e.success){m("error"),p(null!=(s=e.error)?s:"supplier"===y?"We couldn’t send the link. Check your connection and try again.":"We couldn’t send the link. Try again in a few seconds.");return}m("sent"),h(null!=(l=e.normalizedEmail)?l:t)}catch(e){console.error("Portal login: failed to request magic link",e),p("supplier"===y?"We couldn’t send the link. Check your connection and try again.":"We couldn’t send the link. Try again in a few seconds."),m("error")}}(0,a.useEffect)(()=>{w&&console.log("[login] rendering quote-flow login",{nextPath:j})},[w,j]);let k=o[y],S=w?{...k,title:"Log in to request a quote",description:"Use your work email and we'll send you a magic link to your customer workspace.",cta:"Send magic link"}:k;return(0,l.jsxs)("section",{className:"mx-auto max-w-lg rounded-2xl border border-slate-900 bg-slate-950/50 p-6",children:[(0,l.jsxs)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] ".concat(S.accent),children:[y," portal"]}),(0,l.jsx)("h2",{className:"mt-2 text-xl font-semibold text-white",children:S.title}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:S.description}),(0,l.jsxs)("form",{onSubmit:v,className:"mt-5 space-y-3",children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Work email"}),(0,l.jsx)("input",{type:"email",value:d,onChange:e=>c(e.target.value),className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-white focus:outline-none",placeholder:"you@company.com",required:!0}),(0,l.jsx)("button",{type:"submit",disabled:"sending"===u,className:"w-full rounded-full border border-slate-800 bg-white/90 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:bg-white disabled:opacity-60",children:"sending"===u?"Sending...":S.cta}),"sent"===u?(0,l.jsx)("p",{className:"text-sm text-emerald-200",children:"supplier"===y?(0,l.jsxs)(l.Fragment,{children:["Link sent to"," ",(0,l.jsx)("span",{className:"font-mono text-white",children:null!=b?b:d.trim().toLowerCase()})," ","– check your inbox."]}):"Check your inbox for the magic link."}):null,x?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:x}):null,(0,l.jsxs)("p",{className:"text-xs text-slate-500",children:["You’ll land back on ",(0,l.jsx)("span",{className:"font-mono text-slate-300",children:N})," after clicking the link."]})]})]})}},2587:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2619,23)),Promise.resolve().then(s.bind(s,2372)),Promise.resolve().then(s.bind(s,8276)),Promise.resolve().then(s.bind(s,5308)),Promise.resolve().then(s.bind(s,5953)),Promise.resolve().then(s.bind(s,8567))},5308:(e,t,s)=>{"use strict";s.d(t,{SupplierQuoteMessagesCard:()=>c});var l=s(5155),a=s(2115),r=s(7650),n=s(2821),i=s(926);let o=(0,i.createServerReference)("707490b0e799b9bf4ebeb75bb61a4f729dedbd3884",i.callServer,void 0,i.findSourceMapURL,"submitSupplierQuoteMessageAction"),d={ok:!0,message:"",error:"",fieldErrors:{}};function c(e){let{quoteId:t,messages:s,messagesUnavailable:i=!1,messagingUnlocked:c,disableReason:u}=e,[m,x]=(0,a.useState)(!1),p=(0,a.useMemo)(()=>o.bind(null,t),[t]),[b,h]=(0,r.useFormState)(p,d),f=(0,a.useMemo)(()=>{var e,t,s;return{ok:b.ok,message:null!=(e=b.message)?e:"",error:null!=(t=b.error)?t:"",fieldErrors:null!=(s=b.fieldErrors)?s:{}}},[b]),g=m&&!f.ok&&!!f.error,y=m&&f.ok&&!!f.message,j=!c||i;return(0,l.jsxs)("section",{className:"space-y-3 rounded-2xl border border-slate-800 bg-slate-950/60 px-6 py-5",children:[(0,l.jsxs)("header",{children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Messages"}),(0,l.jsx)("h2",{className:"mt-1 text-xl font-semibold text-white heading-tight",children:"Shared chat"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-300",children:"Direct line to the Zartman admin team for build updates and questions."})]}),i?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"Messages are temporarily unavailable. Try reloading the page."}):0===s.length?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"No messages yet. You'll see customer and admin updates here once they post."}):(0,l.jsx)("ol",{className:"space-y-3 text-sm",children:s.map(e=>(0,l.jsxs)("li",{className:"rounded-2xl border border-slate-800 bg-slate-950/40 px-5 py-4",children:[(0,l.jsxs)("div",{className:"mb-1 flex items-center gap-2 text-[11px] uppercase tracking-wide text-slate-500",children:[(0,l.jsx)("span",{className:(0,n.A)("pill px-2.5 py-0.5 text-[10px]","customer"===e.author_type?"pill-success":"admin"===e.author_type?"pill-info":"pill-muted"),children:"customer"===e.author_type?"Customer":"admin"===e.author_type?"Zartman.io":"Supplier"}),(0,l.jsx)("span",{children:e.author_name}),(0,l.jsx)("span",{children:"•"}),(0,l.jsx)("span",{children:new Date(e.created_at).toLocaleString()})]}),(0,l.jsx)("p",{className:"whitespace-pre-wrap text-sm text-slate-100",children:e.body})]},e.id))}),(0,l.jsxs)("div",{className:"space-y-2 border-t border-slate-900/60 pt-3",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-slate-400",children:"Post a message"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-500",children:"Your message notifies the Zartman admin team instantly."}),g&&(0,l.jsx)("p",{className:"rounded-xl border border-red-500/40 bg-red-500/10 px-4 py-2.5 text-xs text-red-200",children:f.error}),y&&(0,l.jsx)("p",{className:"rounded-xl border border-emerald-500/40 bg-emerald-500/10 px-4 py-2.5 text-xs text-emerald-200",children:f.message}),!c&&(0,l.jsx)("p",{className:"text-xs text-slate-500",children:null!=u?u:"Chat unlocks after your bid is accepted for this RFQ."}),(0,l.jsxs)("form",{action:e=>(x(!0),h(e)),className:"mt-1 space-y-2",children:[(0,l.jsx)("textarea",{name:"body",rows:3,className:"w-full rounded-xl border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-slate-100 outline-none ring-emerald-500/50 focus:border-emerald-500/60 focus:ring-1 disabled:cursor-not-allowed disabled:opacity-60",placeholder:"Share build progress, questions, or risks with the Zartman team...",disabled:j}),(0,l.jsx)("button",{type:"submit",className:"inline-flex items-center justify-center rounded-full bg-emerald-400 px-4 py-1.5 text-sm font-semibold text-slate-950 hover:bg-emerald-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:j,children:"Send update"})]})]})]})}},5953:(e,t,s)=>{"use strict";s.d(t,{SupplierQuoteTrackingCard:()=>n});var l=s(5155),a=s(2821),r=s(8799);function n(e){let{events:t,className:s}=e,n=Array.isArray(t)&&t.length>0;return(0,l.jsxs)("section",{className:(0,a.A)(s,"space-y-3"),children:[(0,l.jsxs)("header",{children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"TIMELINE"}),(0,l.jsx)("h2",{className:"mt-1 text-lg font-semibold text-white",children:"Quote activity timeline"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-300",children:"Keep tabs on RFQ milestones, your bid submissions, and final decisions."})]}),n?(0,l.jsx)("ol",{className:"mt-2 space-y-4 border-l border-slate-800 pl-5",children:t.map(e=>(0,l.jsxs)("li",{className:"relative pb-2 last:pb-0",children:[(0,l.jsx)("span",{className:"absolute -left-[6px] mt-1 h-3 w-3 rounded-full border-2 border-blue-400/50 bg-blue-400/10"}),(0,l.jsxs)("div",{className:"space-y-0.5",children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-white",children:e.title}),(0,l.jsx)("p",{className:"text-[11px] text-slate-500",children:(0,r.r)(e.at,{includeTime:!0})}),e.description?(0,l.jsx)("p",{className:"text-xs text-slate-200",children:e.description}):null,e.actorLabel?(0,l.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:e.actorLabel}):null]})]},e.id))}):(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"We’ll surface status changes and your bid history once activity begins."})]})}},8276:(e,t,s)=>{"use strict";s.d(t,{SupplierBidPanel:()=>x});var l=s(5155),a=s(2115),r=s(2821),n=s(7650),i=s(926);let o=(0,i.createServerReference)("603050c98f2b38806e25c401a6b879e6c989fbeac3",i.callServer,void 0,i.findSourceMapURL,"submitSupplierBidAction");var d=s(7275),c=s(8799);function u(e,t,s){var l,a;if("number"!=typeof e||Number.isNaN(e))return"—";let r=(null!=t?t:"USD").toUpperCase(),n=null!=(l=null==s?void 0:s.maximumFractionDigits)?l:0,i=null!=(a=null==s?void 0:s.minimumFractionDigits)?a:n;try{return new Intl.NumberFormat("en-US",{style:"currency",currency:r,minimumFractionDigits:i,maximumFractionDigits:n}).format(e)}catch(s){let t=Math.max(i,n);return"".concat(r," ").concat(e.toFixed(t))}}let m={ok:!0,message:""};function x(e){var t,s,i,d,x,f,g,y;let{quoteId:j,initialBid:N,approvalsOn:w,approved:v,bidsUnavailableMessage:k}=e,S=(0,a.useRef)(null),[_,P]=(0,a.useState)(!1),[C,E]=(0,n.useFormState)(o,m),L=(0,a.useMemo)(()=>(function(e){var t,s;if(!e)return{ok:!0,message:""};if(e.ok){return{ok:!0,message:null!=(t=e.message)?t:""}}return{ok:!1,error:e.error||"We couldn't submit your bid. Please try again.",fieldErrors:(s=e.fieldErrors)&&"object"==typeof s?Object.entries(s).reduce((e,t)=>{let[s,l]=t;return"string"==typeof l&&l.length>0&&(e[s]=l),e},{}):{}}})(C),[C]),M=(0,a.useMemo)(()=>(function(e){var t;if(!e)return"";let s="number"==typeof e.amount?u(e.amount,e.currency,{maximumFractionDigits:2}):null,l=s&&"—"!==s?s:null,a=null!=(t=e.updated_at)?t:e.created_at,r=a?(0,c.r)(a):null;return l&&r?"".concat(l," bid on file (submitted ").concat(r,"). Update it anytime."):l?"".concat(l," bid on file. Update it anytime."):r?"Bid submitted ".concat(r,". Update it anytime."):"Your latest bid is on file. Update it anytime."})(N),[N]),U=_&&L.ok&&!!L.message,F=!_&&!!N,R=U?L.message:F?M:"";(0,a.useEffect)(()=>{if(U){var e;null==(e=S.current)||e.reset()}},[U]);let q=w&&!v||!!k,D=N?"Update bid":"Submit bid",W=null!=(s=null!=(t=null==N?void 0:N.updated_at)?t:null==N?void 0:N.created_at)?s:null;return(0,l.jsxs)("div",{className:"space-y-4",children:[w&&!v?(0,l.jsx)("p",{className:"rounded-xl border border-yellow-500/30 bg-yellow-500/5 px-3 py-2 text-xs text-yellow-100",children:"Your profile is pending review. You can edit your profile, but bids will open up once you’re approved."}):null,k?(0,l.jsx)("p",{className:"rounded-xl border border-slate-800 bg-black/40 px-3 py-2 text-xs text-slate-300",children:k}):null,(0,l.jsxs)("form",{ref:S,action:e=>{var t;return P(!0),e.set("amount","string"!=typeof(t=e.get("amount"))?"":t.trim().replace(/[,\s]/g,"")),E(e)},className:"space-y-4",children:[(0,l.jsx)("input",{type:"hidden",name:"quoteId",value:j}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,l.jsx)(p,{label:"Amount",name:"amount",type:"text",inputMode:"decimal",placeholder:"15000",defaultValue:null!=(i=null==N?void 0:N.amount)?i:void 0,disabled:q,prefix:"$",autoComplete:"off",error:_&&!L.ok?L.fieldErrors.amount:void 0}),(0,l.jsx)(p,{label:"Currency",name:"currency",placeholder:"USD",defaultValue:null!=(d=null==N?void 0:N.currency)?d:"USD",disabled:q}),(0,l.jsx)(p,{label:"Lead time (days)",name:"leadTimeDays",type:"number",placeholder:"14",defaultValue:"number"==typeof(null==N?void 0:N.lead_time_days)?N.lead_time_days:void 0,disabled:q,error:_&&!L.ok?L.fieldErrors.leadTimeDays:void 0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Notes & certifications"}),(0,l.jsx)("textarea",{name:"notes",defaultValue:null!=(x=null==N?void 0:N.notes)?x:"",rows:4,disabled:q,className:"mt-1 w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-400 focus:outline-none disabled:opacity-60",placeholder:"Call out certifications, MOQ, inspection plans, or anything the customer should know."})]}),_&&!L.ok?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:L.error}):null,(U||F)&&R?(0,l.jsx)("p",{className:"text-sm text-emerald-300",role:"status",children:R}):null,(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,l.jsx)(h,{label:D,disabled:q}),(null==N?void 0:N.status)?(0,l.jsxs)("span",{className:(0,r.A)("pill px-3 py-1 text-[11px]",null!=(g=b[(null!=(f=N.status)?f:"submitted").toString().toLowerCase()])?g:"pill-info"),children:["Status: ",(null!=(y=N.status)?y:"submitted").toString()]}):null]})]}),N?(0,l.jsxs)("div",{className:"rounded-xl border border-slate-900/60 bg-slate-950/30 px-6 py-4 text-sm text-slate-200",children:[(0,l.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Last submitted"}),(0,l.jsxs)("dl",{className:"mt-2 grid gap-3 sm:grid-cols-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Amount"}),(0,l.jsx)("dd",{className:"font-medium text-slate-100",children:"number"==typeof N.amount?u(N.amount,N.currency):"—"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Lead time"}),(0,l.jsx)("dd",{className:"font-medium text-slate-100",children:"number"==typeof N.lead_time_days?"".concat(N.lead_time_days," day").concat(1===N.lead_time_days?"":"s"):"—"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Submitted"}),(0,l.jsx)("dd",{className:"font-medium text-slate-100",children:W?(0,c.r)(W):"—"})]})]}),N.notes?(0,l.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:N.notes}):null]}):null]})}function p(e){let{label:t,name:s,type:a="text",placeholder:r,defaultValue:n,disabled:i,step:o,prefix:d,error:c,inputMode:u,autoComplete:m}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:t}),(0,l.jsxs)("div",{className:"mt-1 flex items-center rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus-within:border-blue-400",children:[d?(0,l.jsx)("span",{className:"mr-1 text-slate-500",children:d}):null,(0,l.jsx)("input",{type:a,name:s,placeholder:r,defaultValue:n,disabled:i,step:o,inputMode:u,autoComplete:m,className:"w-full bg-transparent text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none disabled:opacity-60"})]}),c?(0,l.jsx)("p",{className:"mt-1 text-xs text-red-300",role:"alert",children:c}):null]})}let b={accepted:"pill-success",won:"pill-success",declined:"pill-warning",lost:"pill-warning",withdrawn:"pill-muted",submitted:"pill-info",pending:"pill-info"};function h(e){let{label:t,disabled:s}=e,{pending:a}=(0,n.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:a||s,className:"".concat(d.n4," ").concat(d.m.md," ").concat(a||s?"opacity-60":""),children:a?"Saving...":t})}}},e=>{e.O(0,[2619,5246,8441,1255,7358],()=>e(e.s=2587)),_N_E=e.O()}]);