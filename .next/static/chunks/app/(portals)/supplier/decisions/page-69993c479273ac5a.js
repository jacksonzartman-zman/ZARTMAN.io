(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[680],{63:(e,t,n)=>{"use strict";var r=n(7260);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},926:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{callServer:function(){return r.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return a.findSourceMapURL}});let r=n(1209),a=n(5153),l=n(7197)},3296:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2619,23)),Promise.resolve().then(n.bind(n,8166))},8166:(e,t,n)=>{"use strict";n.d(t,{PortalLoginPanel:()=>c});var r=n(5155),a=n(2115),l=n(63),s=n(926);let o=(0,s.createServerReference)("4045ea18b31e7bc7acdff8c88de12aaed936b3c368",s.callServer,void 0,s.findSourceMapURL,"requestMagicLinkForEmail"),i={customer:{title:"Customer workspace",description:"Use your work email and we’ll send you a magic link to your workspace.",accent:"text-emerald-300",cta:"Email me a link"},supplier:{title:"Supplier workspace",description:"Use the email you onboarded with and we’ll send you a magic link.",accent:"text-blue-300",cta:"Send magic link"}};function c(e){let{role:t,fallbackRedirect:n,nextPath:s}=e,[c,u]=(0,a.useState)(""),[d,m]=(0,a.useState)("idle"),[p,h]=(0,a.useState)(null),[f,x]=(0,a.useState)(null),g=(0,l.usePathname)(),b=Object.prototype.hasOwnProperty.call(i,t);b||console.warn("[portal-login] unknown role received, defaulting to customer",{role:t});let k=b?t:"customer",y="string"==typeof s&&s.startsWith("/")?s:null,w=null!=y?y:"string"==typeof g&&g.startsWith("/".concat(k))?g:n,S=!!y&&("/quote"===y||y.startsWith("/quote"));async function v(e){e.preventDefault();let t=c.trim().toLowerCase();if(!t||!t.includes("@")){h("supplier"===k?"Enter a business email that matches your onboarding profile.":"Enter a valid work email."),m("error");return}try{var n,r;m("sending"),h(null);let e=await o({role:k,email:t,nextPath:w});if(!e.success){m("error"),h(null!=(n=e.error)?n:"supplier"===k?"We couldn’t send the link. Check your connection and try again.":"We couldn’t send the link. Try again in a few seconds.");return}m("sent"),x(null!=(r=e.normalizedEmail)?r:t)}catch(e){console.error("Portal login: failed to request magic link",e),h("supplier"===k?"We couldn’t send the link. Check your connection and try again.":"We couldn’t send the link. Try again in a few seconds."),m("error")}}(0,a.useEffect)(()=>{S&&console.log("[login] rendering quote-flow login",{nextPath:y})},[S,y]);let j=i[k],P=S?{...j,title:"Log in to request a quote",description:"Use your work email and we'll send you a magic link to your customer workspace.",cta:"Send magic link"}:j;return(0,r.jsxs)("section",{className:"mx-auto max-w-lg rounded-2xl border border-slate-900 bg-slate-950/50 p-6",children:[(0,r.jsxs)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] ".concat(P.accent),children:[k," portal"]}),(0,r.jsx)("h2",{className:"mt-2 text-xl font-semibold text-white",children:P.title}),(0,r.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:P.description}),(0,r.jsxs)("form",{onSubmit:v,className:"mt-5 space-y-3",children:[(0,r.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Work email"}),(0,r.jsx)("input",{type:"email",value:c,onChange:e=>u(e.target.value),className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-white focus:outline-none",placeholder:"you@company.com",required:!0}),(0,r.jsx)("button",{type:"submit",disabled:"sending"===d,className:"w-full rounded-full border border-slate-800 bg-white/90 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:bg-white disabled:opacity-60",children:"sending"===d?"Sending...":P.cta}),"sent"===d?(0,r.jsx)("p",{className:"text-sm text-emerald-200",children:"supplier"===k?(0,r.jsxs)(r.Fragment,{children:["Link sent to"," ",(0,r.jsx)("span",{className:"font-mono text-white",children:null!=f?f:c.trim().toLowerCase()})," ","– check your inbox."]}):"Check your inbox for the magic link."}):null,p?(0,r.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:p}):null,(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:["You’ll land back on ",(0,r.jsx)("span",{className:"font-mono text-slate-300",children:w})," after clicking the link."]})]})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=3296)),_N_E=e.O()}]);