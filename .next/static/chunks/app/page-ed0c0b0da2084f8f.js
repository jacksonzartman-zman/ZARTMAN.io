(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4351:(e,t,a)=>{Promise.resolve().then(a.bind(a,5772))},5772:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var n=a(5155),i=a(2115);function l(){let e=(0,i.useRef)(null),[t,a]=(0,i.useState)("Select a CAD file to begin.");async function l(e){var t,n,i,l;let o=null==(t=e.target.files)?void 0:t[0];if(!o)return;a(["Picked: ".concat(o.name," (").concat(o.type||"unknown",") • ").concat(o.size.toLocaleString()," bytes"),"\uD83D\uDCE4 Uploading…"].join("\n"));let c=new FormData;c.append("file",o);try{let e,t=await fetch("/api/upload",{method:"POST",body:c}),l=await t.text();try{e=l?JSON.parse(l):void 0}catch(t){e=void 0}if(t.ok&&(null==e?void 0:e.ok)){let t=["✅ Upload complete: ".concat(o.name),"Storage key: ".concat(e.key),e.publicUrl?"Public URL: ".concat(e.publicUrl):"Public URL: (not public)"];a(t.join("\n"));let n={filename:o.name,size_bytes:o.size,mime:o.type||null,storage_path:e.key||null};try{let e=await fetch("/api/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){let t=await e.json().catch(()=>({}));a(a=>{var n;return[a,"⚠️ Metadata save failed: ".concat(null!=(n=null==t?void 0:t.error)?n:"".concat(e.status," ").concat(e.statusText))].join("\n")})}}catch(e){a(t=>{var a;return[t,"⚠️ Metadata save error: ".concat(null!=(a=null==e?void 0:e.message)?a:String(e))].join("\n")})}}else{let l=null!=(n=null==e?void 0:e.step)?n:"unknown",o=null!=(i=null==e?void 0:e.error)?i:"Request failed with ".concat(t.status," ").concat(t.statusText),c=e?"Diagnostics: ".concat(JSON.stringify(e,null,2)):void 0;a(['❌ Upload failed at step "'.concat(l,'".'),"Reason: ".concat(o),c].filter(Boolean).join("\n"))}}catch(e){a("❌ Network error: ".concat(null!=(l=null==e?void 0:e.message)?l:String(e)))}}return(0,n.jsxs)("div",{style:{display:"grid",gap:10,maxWidth:520},children:[(0,n.jsx)("input",{ref:e,type:"file",accept:".step,.stp,.iges,.igs,.stl,.obj,.zip",onChange:l,style:{position:"absolute",opacity:0,width:1,height:1}}),(0,n.jsx)("button",{type:"button",onClick:()=>{var t;return null==(t=e.current)?void 0:t.click()},style:{padding:"10px 16px",borderRadius:999,background:"#1db954",fontWeight:600},"aria-label":"Upload your CAD",children:"Upload your CAD"}),(0,n.jsx)("pre",{"aria-live":"polite",style:{whiteSpace:"pre-wrap",fontSize:12,background:"#0f1115",padding:10,borderRadius:8},children:t})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=4351)),_N_E=e.O()}]);