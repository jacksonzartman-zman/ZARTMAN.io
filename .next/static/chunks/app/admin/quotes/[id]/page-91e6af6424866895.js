(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{3385:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2619,23)),Promise.resolve().then(s.bind(s,8567)),Promise.resolve().then(s.bind(s,7791)),Promise.resolve().then(s.bind(s,9867)),Promise.resolve().then(s.bind(s,3558)),Promise.resolve().then(s.bind(s,8629))},3558:(e,t,s)=>{"use strict";s.d(t,{SupplierBidsCard:()=>x});var l=s(5155),a=s(2115),r=s(7650),n=s(7344),d=s(8799),o=s(926);let c=(0,o.createServerReference)("709f18d3f55092182f4c1fe14972b6c338b697811f",o.callServer,void 0,o.findSourceMapURL,"submitSelectWinningBidAction"),i=["won","lost","cancelled"],u={ok:!0,message:""},m="Winning bid selected. Quote status updated to Won.";function x(e){let{quoteId:t,quoteStatus:s,bids:o,bidsLoaded:x,errorMessage:p}=e,[h,f]=(0,a.useState)(!1),[j,N]=(0,r.useFormState)(c.bind(null,t),u),y=(0,a.useMemo)(()=>(function(e){if(!e)return{ok:!0,message:""};if(e.ok){var t;return{ok:!0,message:null!=(t=e.message)?t:""}}return{ok:!1,error:e.error||"We couldn't update this quote. Please try again."}})(j),[j]),v=i.includes(s),g=(0,a.useMemo)(()=>o.some(e=>{var t;return"won"===(null!=(t=e.status)?t:"").toLowerCase()}),[o]),w=!h&&g,k=h&&y.ok&&!!y.message,S=y.ok?y.message:"",_=w?m:S,F=w&&!!m||k&&!!S,q=h&&!y.ok;return(0,l.jsxs)("section",{className:"mt-8 rounded-2xl border border-slate-900 bg-slate-950/40 p-4",children:[(0,l.jsxs)("div",{className:"mb-3 flex items-center justify-between gap-2",children:[(0,l.jsx)("h2",{className:"text-sm font-semibold text-slate-100",children:"Supplier bids"}),x?null:(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"We had trouble loading bids. Check logs and try again."})]}),F&&_?(0,l.jsx)("p",{className:"mb-3 rounded-lg border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-xs font-medium text-emerald-200",role:"status",children:_}):null,q?(0,l.jsx)("p",{className:"mb-3 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs font-medium text-red-200",role:"alert",children:y.error}):null,p&&x?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:p}):null,x&&0===o.length?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"No bids have been submitted for this quote yet."}):null,x&&o.length>0?(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-left text-xs text-slate-200",children:[(0,l.jsx)("thead",{className:"border-b border-slate-800 text-[11px] uppercase tracking-wide text-slate-400",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2 pr-3",children:"Supplier"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Amount"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Lead time"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Status"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Submitted"}),(0,l.jsx)("th",{className:"py-2 pr-3 text-right",children:"Action"})]})}),(0,l.jsx)("tbody",{children:o.map(e=>{var t;let s="number"==typeof e.amount?(0,n.v)(e.amount,e.currency,{maximumFractionDigits:2}):"—",a=e.created_at?(0,d.r)(e.created_at):"—",r=(null!=(t=e.status)?t:"submitted").toString(),o="won"===r.toLowerCase();return(0,l.jsxs)("tr",{className:"border-b border-slate-900/60 last:border-0",children:[(0,l.jsx)("td",{className:"py-2 pr-3",children:(0,l.jsx)("span",{className:"font-mono text-[11px] text-slate-400",children:e.supplier_id})}),(0,l.jsxs)("td",{className:"py-2 pr-3",children:[s,e.currency?(0,l.jsx)("span",{className:"ml-1 text-[11px] text-slate-400",children:e.currency}):null]}),(0,l.jsx)("td",{className:"py-2 pr-3",children:"number"==typeof e.lead_time_days?"".concat(e.lead_time_days," day").concat(1===e.lead_time_days?"":"s"):"—"}),(0,l.jsx)("td",{className:"py-2 pr-3",children:(0,l.jsx)("span",{className:"inline-flex rounded-full bg-slate-800/60 px-2 py-0.5 text-[11px] capitalize",children:r})}),(0,l.jsx)("td",{className:"py-2 pr-3",children:a}),(0,l.jsx)("td",{className:"py-2 pr-3",children:o?(0,l.jsx)("span",{className:"inline-flex items-center justify-end rounded-full bg-emerald-500/10 px-2 py-0.5 text-[11px] font-semibold text-emerald-200",children:"Winner"}):v||o?null:(0,l.jsxs)("form",{action:e=>(f(!0),N(e)),className:"flex justify-end",children:[(0,l.jsx)("input",{type:"hidden",name:"bidId",value:e.id}),(0,l.jsx)(b,{})]})})]},e.id)})})]})}):null]})}function b(){let{pending:e}=(0,r.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:"text-xs font-medium text-emerald-300 transition hover:text-emerald-200 disabled:cursor-not-allowed disabled:text-slate-500",children:e?"Selecting...":"Mark as winner"})}},7791:(e,t,s)=>{"use strict";s.d(t,{QuoteMessageComposer:()=>i});var l=s(5155),a=s(2115),r=s(7650),n=s(926);let d=(0,n.createServerReference)("60d48f1be6255f9cbc9b434361df97ef197922055d",n.callServer,void 0,n.findSourceMapURL,"postQuoteMessageAction");var o=s(7275);let c={success:!1,error:null};function i(e){let{quoteId:t}=e,s=(0,a.useRef)(null),n=(0,a.useRef)(null),[o,i]=(0,r.useFormState)(d,c);return(0,a.useEffect)(()=>{var e;o.success&&(null==(e=s.current)||e.reset(),n.current&&(n.current.value=""))},[o.success,o.messageId]),(0,l.jsxs)("form",{ref:s,action:i,className:"space-y-3",children:[(0,l.jsx)("input",{type:"hidden",name:"quote_id",value:t}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{htmlFor:"quote-message-body",className:"text-sm font-medium text-slate-200",children:"Message"}),(0,l.jsx)("textarea",{id:"quote-message-body",name:"body",ref:n,rows:4,maxLength:2e3,className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none",placeholder:"Share an update or question for this quote..."})]}),o.error&&(0,l.jsx)("p",{className:"text-sm text-red-400",role:"alert","aria-live":"polite",children:o.error}),(0,l.jsx)(u,{})]})}function u(){let{pending:e}=(0,r.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:"".concat(o.n4," ").concat(o.m.md," w-full sm:w-auto"),children:e?"Sending...":"Send message"})}},8629:(e,t,s)=>{"use strict";s.d(t,{default:()=>b});var l=s(5155),a=s(7650),r=s(2821),n=s(8799);let d={submitted:"RFQ submitted",in_review:"In review",quoted:"Quote prepared",won:"Won",lost:"Lost",cancelled:"Cancelled"};var o=s(7275),c=s(926);let i=(0,c.createServerReference)("704e4fb6cf93cc825b37bb560f36497e628be0e34f",c.callServer,void 0,c.findSourceMapURL,"submitAdminQuoteUpdateAction"),u=["USD","EUR","GBP"],m=["submitted","in_review","quoted","won","lost","cancelled"].map(e=>({value:e,label:d[e]})),x={ok:!0,message:""};function b(e){var t,s,r,d;let{quote:o}=e,c=i.bind(null,o.id),[b,h]=(0,a.useFormState)(c,x);return(0,l.jsxs)("form",{className:"mt-4 space-y-4",action:h,children:[(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-200",children:"Status"}),(0,l.jsx)("select",{id:"status",name:"status",defaultValue:function(e){let t=(null!=e?e:"").toLowerCase().trim();return"in_review"===t?"in_review":"quoted"===t?"quoted":"won"===t?"won":"lost"===t?"lost":"cancelled"===t||"canceled"===t?"cancelled":"submitted"}(null!=(t=o.status)?t:"submitted"),className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",children:m.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-slate-200",children:"Price"}),(0,l.jsx)("input",{id:"price",name:"price",type:"number",step:"0.01",inputMode:"decimal",defaultValue:null!=(s=o.price)?s:"",placeholder:"0.00",className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-200",children:"Currency"}),(0,l.jsx)("select",{id:"currency",name:"currency",defaultValue:o.currency||"USD",className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",children:u.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"targetDate",className:"block text-sm font-medium text-slate-200",children:"Target date"}),(0,l.jsx)("input",{id:"targetDate",name:"targetDate",type:"date",defaultValue:(0,n.l)(o.targetDate),className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"dfmNotes",className:"block text-sm font-medium text-slate-200",children:"DFM notes (visible to customer)"}),(0,l.jsx)("textarea",{id:"dfmNotes",name:"dfmNotes",defaultValue:null!=(r=o.dfmNotes)?r:"",rows:4,className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",placeholder:"Call out manufacturability feedback you want to share"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Customers will eventually see these notes on their quote."})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"internalNotes",className:"block text-sm font-medium text-slate-200",children:"Internal notes"}),(0,l.jsx)("textarea",{id:"internalNotes",name:"internalNotes",defaultValue:null!=(d=o.internalNotes)?d:"",rows:4,className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),!b.ok&&b.error&&(0,l.jsx)("p",{className:"text-sm text-red-400",children:b.error}),b.ok&&b.message&&(0,l.jsx)("p",{className:"text-sm text-emerald-300",children:b.message}),(0,l.jsx)("div",{className:"flex flex-col gap-3 pt-1 sm:flex-row sm:justify-end",children:(0,l.jsx)(p,{})})]})}function p(){let{pending:e}=(0,a.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:(0,r.A)(o.n4,o.m.md,"w-full sm:w-auto"),children:e?"Saving...":"Save changes"})}}},e=>{e.O(0,[619,297,441,255,358],()=>e(e.s=3385)),_N_E=e.O()}]);