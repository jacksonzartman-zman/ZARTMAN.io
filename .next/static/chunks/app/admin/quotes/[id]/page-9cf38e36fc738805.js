(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{438:(e,t,s)=>{"use strict";s.d(t,{SupplierBidsCard:()=>x});var l=s(5155),a=s(2115),r=s(7650),d=s(7344),n=s(8799),o=s(926);let i=(0,o.createServerReference)("70dfdf2290c2eec601298c41de440e9df070239113",o.callServer,void 0,o.findSourceMapURL,"submitSelectWinningBidAction"),c=["won","lost","cancelled"],m={ok:!0,message:""},u="Winning bid selected. Quote status updated to Won.";function x(e){let{quoteId:t,quoteStatus:s,bids:o,bidsLoaded:x,errorMessage:b}=e,[h,f]=(0,a.useState)(!1),[j,N]=(0,r.useFormState)(i.bind(null,t),m),g=(0,a.useMemo)(()=>(function(e){if(!e)return{ok:!0,message:""};if(e.ok){var t;return{ok:!0,message:null!=(t=e.message)?t:""}}return{ok:!1,error:e.error||"We couldn't update this quote. Please try again."}})(j),[j]),y=c.includes(s),v=(0,a.useMemo)(()=>o.some(e=>{var t;return"won"===(null!=(t=e.status)?t:"").toLowerCase()}),[o]),w=!h&&v,k=h&&g.ok&&!!g.message,S=g.ok?g.message:"",_=w?u:S,F=w&&!!u||k&&!!S,C=h&&!g.ok;return(0,l.jsxs)("section",{className:"mt-8 rounded-2xl border border-slate-900 bg-slate-950/40 p-4",children:[(0,l.jsxs)("div",{className:"mb-3 flex items-center justify-between gap-2",children:[(0,l.jsx)("h2",{className:"text-sm font-semibold text-slate-100",children:"Supplier bids"}),x?null:(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"We had trouble loading bids. Check logs and try again."})]}),F&&_?(0,l.jsx)("p",{className:"mb-3 rounded-lg border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-xs font-medium text-emerald-200",role:"status",children:_}):null,C?(0,l.jsx)("p",{className:"mb-3 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs font-medium text-red-200",role:"alert",children:g.error}):null,b&&x?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:b}):null,x&&0===o.length?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"No bids have been submitted for this quote yet."}):null,x&&o.length>0?(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-left text-xs text-slate-200",children:[(0,l.jsx)("thead",{className:"border-b border-slate-800 text-[11px] uppercase tracking-wide text-slate-400",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2 pr-3",children:"Supplier"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Amount"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Lead time"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Status"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Submitted"}),(0,l.jsx)("th",{className:"py-2 pr-3 text-right",children:"Action"})]})}),(0,l.jsx)("tbody",{children:o.map(e=>{var t;let s="number"==typeof e.amount?(0,d.v)(e.amount,e.currency,{maximumFractionDigits:2}):"—",a=e.created_at?(0,n.r)(e.created_at):"—",r=(null!=(t=e.status)?t:"submitted").toString(),o="won"===r.toLowerCase();return(0,l.jsxs)("tr",{className:"border-b border-slate-900/60 last:border-0",children:[(0,l.jsx)("td",{className:"py-2 pr-3",children:(0,l.jsx)("span",{className:"font-mono text-[11px] text-slate-400",children:e.supplier_id})}),(0,l.jsxs)("td",{className:"py-2 pr-3",children:[s,e.currency?(0,l.jsx)("span",{className:"ml-1 text-[11px] text-slate-400",children:e.currency}):null]}),(0,l.jsx)("td",{className:"py-2 pr-3",children:"number"==typeof e.lead_time_days?"".concat(e.lead_time_days," day").concat(1===e.lead_time_days?"":"s"):"—"}),(0,l.jsx)("td",{className:"py-2 pr-3",children:(0,l.jsx)("span",{className:"inline-flex rounded-full bg-slate-800/60 px-2 py-0.5 text-[11px] capitalize",children:r})}),(0,l.jsx)("td",{className:"py-2 pr-3",children:a}),(0,l.jsx)("td",{className:"py-2 pr-3",children:o?(0,l.jsx)("span",{className:"inline-flex items-center justify-end rounded-full bg-emerald-500/10 px-2 py-0.5 text-[11px] font-semibold text-emerald-200",children:"Winner"}):y||o?null:(0,l.jsxs)("form",{action:e=>(f(!0),N(e)),className:"flex justify-end",children:[(0,l.jsx)("input",{type:"hidden",name:"bidId",value:e.id}),(0,l.jsx)(p,{})]})})]},e.id)})})]})}):null]})}function p(){let{pending:e}=(0,r.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:"text-xs font-medium text-emerald-300 transition hover:text-emerald-200 disabled:cursor-not-allowed disabled:text-slate-500",children:e?"Selecting...":"Mark as winner"})}},5077:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2619,23)),Promise.resolve().then(s.bind(s,6940)),Promise.resolve().then(s.bind(s,5798)),Promise.resolve().then(s.bind(s,8567)),Promise.resolve().then(s.bind(s,9867)),Promise.resolve().then(s.bind(s,438)),Promise.resolve().then(s.bind(s,9609))},5798:(e,t,s)=>{"use strict";s.d(t,{AdminQuoteProjectCard:()=>u});var l=s(5155),a=s(2821),r=s(2115),d=s(7650),n=s(7275),o=s(926);let i=(0,o.createServerReference)("70b7fc98baff32e7d13b9af20ce5c77d6a9dfc172f",o.callServer,void 0,o.findSourceMapURL,"submitAdminQuoteProjectAction");var c=s(8799);let m={ok:!0};function u(e){var t,s,n,o,u;let{quoteId:b,project:h,projectUnavailable:f=!1,className:j}=e,[N,g]=(0,r.useState)(!1),y=(0,r.useMemo)(()=>i.bind(null,b),[b]),[v,w]=(0,d.useFormState)(y,m),k=(0,r.useMemo)(()=>(function(e){var t,s,l,a,r;let d=null!=e?e:m;return{ok:d.ok,message:null!=(a=d.message)?a:"",error:null!=(r=d.error)?r:"",fieldErrors:{poNumber:null==(t=d.fieldErrors)?void 0:t.poNumber,targetShipDate:null==(s=d.fieldErrors)?void 0:s.targetShipDate,notes:null==(l=d.fieldErrors)?void 0:l.notes}}})(v),[v]),S=N&&!k.ok&&!!k.error,_=N&&k.ok&&!!k.message,F=N&&!k.ok,C=(null==h?void 0:h.target_ship_date)?h.target_ship_date.slice(0,10):"",P=(null==h?void 0:h.target_ship_date)?null!=(t=(0,c.r)(h.target_ship_date))?t:h.target_ship_date:"",R=null!=(s=null==h?void 0:h.notes)?s:"",M=!h&&!f;return(0,l.jsxs)("section",{className:(0,a.A)(j,"space-y-4"),children:[(0,l.jsxs)("header",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Project kickoff"}),(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Customer PO + target ship date"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Capture the handoff metadata the moment a quote is marked Won. The customer and winning supplier see these details."})]}),f?(0,l.jsx)("p",{className:"rounded-xl border border-yellow-500/30 bg-yellow-500/10 px-3 py-2 text-xs text-yellow-100",children:"Project details are temporarily unavailable."}):null,(0,l.jsxs)("dl",{className:"grid gap-3 text-sm text-slate-200 sm:grid-cols-2",children:[(0,l.jsx)(x,{label:"PO number",value:null!=(n=null==h?void 0:h.po_number)?n:null,placeholder:"Pending"}),(0,l.jsx)(x,{label:"Target ship date",value:P||null,placeholder:"Not set"}),(0,l.jsx)(x,{label:"Kickoff notes",value:null!=(o=null==h?void 0:h.notes)?o:null,placeholder:"No kickoff notes yet.",multiline:!0,className:"sm:col-span-2"})]}),(0,l.jsxs)("form",{action:e=>(g(!0),w(e)),className:"space-y-3",children:[M?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"No kickoff details saved yet. Capture the PO number, target ship date, and any notes as soon as the quote is awarded."}):null,_&&k.message?(0,l.jsx)("p",{className:"rounded-xl border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-100",children:k.message}):null,S&&k.error?(0,l.jsx)("p",{className:"rounded-xl border border-red-500/30 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:k.error}):null,(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{htmlFor:"admin-project-po",className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"PO number"}),(0,l.jsx)("input",{id:"admin-project-po",name:"poNumber",type:"text",maxLength:100,defaultValue:null!=(u=null==h?void 0:h.po_number)?u:"",disabled:f,className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60",placeholder:"PO-12345"}),F&&k.fieldErrors.poNumber?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:k.fieldErrors.poNumber}):null]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{htmlFor:"admin-project-target-date",className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Target ship date"}),(0,l.jsx)("input",{id:"admin-project-target-date",name:"targetShipDate",type:"date",defaultValue:C,disabled:f,className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60"}),F&&k.fieldErrors.targetShipDate?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:k.fieldErrors.targetShipDate}):null]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{htmlFor:"admin-project-notes",className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Kickoff notes"}),(0,l.jsx)("textarea",{id:"admin-project-notes",name:"notes",rows:4,defaultValue:R,maxLength:2e3,disabled:f,className:"w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60",placeholder:"Share packaging, address, or handoff context customers and suppliers should remember."}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Customers can edit these details, and the winning supplier sees them in read-only mode."}),F&&k.fieldErrors.notes?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:k.fieldErrors.notes}):null]}),(0,l.jsx)(p,{disabled:f})]})]})}function x(e){let{label:t,value:s,placeholder:a="—",multiline:r=!1,className:d=""}=e,n="string"==typeof s&&s.trim().length>0?s:a,o=[r?"whitespace-pre-line text-sm font-normal":"font-medium","text-slate-100"].join(" ");return(0,l.jsxs)("div",{className:"rounded-xl border border-slate-900/60 bg-slate-950/30 px-3 py-2 ".concat(d).trim(),children:[(0,l.jsx)("dt",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:t}),(0,l.jsx)("dd",{className:o,children:n})]})}function p(e){let{disabled:t}=e,{pending:s}=(0,d.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:s||t,className:"".concat(n.n4," ").concat(n.m.sm),children:s?"Saving...":"Save project details"})}},6940:(e,t,s)=>{"use strict";s.d(t,{AdminQuoteMessagesCard:()=>u});var l=s(5155),a=s(2115),r=s(7650),d=s(8799),n=s(7275),o=s(926);let i=(0,o.createServerReference)("7005aba496124abda0e4343e9ab6481866f0e2d6b3",o.callServer,void 0,o.findSourceMapURL,"submitAdminQuoteMessageAction"),c={ok:!0},m={customer:"Customer",admin:"Zartman.io",supplier:"Supplier"};function u(e){let{quoteId:t,messages:s,messagesUnavailable:d=!1}=e,n=(0,a.useRef)(null),o=(0,a.useRef)(null),m=(0,a.useMemo)(()=>i.bind(null,t),[t]),[u,b]=(0,r.useFormState)(m,c);(0,a.useEffect)(()=>{var e;u.ok&&u.message&&(null==(e=n.current)||e.reset(),o.current&&(o.current.value=""))},[u.ok,u.message]);let h=s.length>0;return(0,l.jsxs)("section",{className:"space-y-4 rounded-2xl border border-slate-900 bg-slate-950/60 p-4",children:[(0,l.jsxs)("header",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Customer messages"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Customer messages"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Use this thread to keep RFQ context in one place."})]})]}),d?(0,l.jsx)("p",{className:"rounded-xl border border-yellow-500/30 bg-yellow-500/5 px-3 py-2 text-sm text-yellow-100",children:"Messages are temporarily unavailable. Refresh to try again."}):null,(0,l.jsx)(x,{messages:s,hasMessages:h}),(0,l.jsxs)("div",{className:"space-y-3 border-t border-slate-900/60 pt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-slate-100",children:"Reply"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Visible to the requesting customer and Zartman admins."})]}),(0,l.jsx)(p,{ref:n,textareaRef:o,onSubmit:b,state:u,disabled:d})]})]})}function x(e){let{messages:t,hasMessages:s}=e;return s?(0,l.jsx)("ol",{className:"space-y-3",children:t.map(e=>{var t,s;return(0,l.jsxs)("li",{className:"rounded-2xl border border-slate-900/70 bg-slate-950/40 px-4 py-3",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-slate-400",children:[(0,l.jsx)("span",{className:"font-semibold text-slate-100",children:null!=(t=m[e.author_type])?t:m.admin}),(0,l.jsx)("span",{children:null!=(s=(0,d.r)(e.created_at,{includeTime:!0}))?s:""})]}),(0,l.jsx)("p",{className:"mt-2 whitespace-pre-wrap text-sm leading-relaxed text-slate-100",children:e.body})]},e.id)})}):(0,l.jsx)("p",{className:"rounded-2xl border border-dashed border-slate-800/70 bg-black/30 px-4 py-4 text-sm text-slate-400",children:"No messages yet. Reply here to keep the customer looped in."})}let p=(0,a.forwardRef)((e,t)=>{var s;let{onSubmit:a,state:r,disabled:d=!1,textareaRef:n}=e,o=null==(s=r.fieldErrors)?void 0:s.body,i=r.ok&&!!r.message;return(0,l.jsxs)("form",{ref:t,action:a,className:"space-y-3",children:[i?(0,l.jsx)("p",{className:"rounded-xl border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-100",children:r.message}):null,!r.ok&&r.error?(0,l.jsx)("p",{className:"rounded-xl border border-red-500/30 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:r.error}):null,(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{htmlFor:"admin-quote-message-body",className:"text-sm font-medium text-slate-200",children:"Message"}),(0,l.jsx)("textarea",{id:"admin-quote-message-body",name:"body",ref:n,rows:4,maxLength:2e3,disabled:d,className:"w-full rounded-lg border border-slate-800 bg-black/30 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60",placeholder:"Share an update or ask a follow-up question..."}),o?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:o}):null]}),(0,l.jsx)(b,{disabled:d})]})});function b(e){let{disabled:t}=e,{pending:s}=(0,r.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:s||t,className:"".concat(n.n4," ").concat(n.m.md," w-full sm:w-auto"),children:s?"Sending...":"Reply"})}p.displayName="AdminQuoteMessageComposerForm"},9609:(e,t,s)=>{"use strict";s.d(t,{default:()=>p});var l=s(5155),a=s(7650),r=s(2821),d=s(8799);let n={submitted:"RFQ submitted",in_review:"In review",quoted:"Quote prepared",won:"Won",lost:"Lost",cancelled:"Cancelled"};var o=s(7275),i=s(926);let c=(0,i.createServerReference)("7005835a831c3c7b75b7e6a9d3a542024839f19bca",i.callServer,void 0,i.findSourceMapURL,"submitAdminQuoteUpdateAction"),m=["USD","EUR","GBP"],u=["submitted","in_review","quoted","won","lost","cancelled"].map(e=>({value:e,label:n[e]})),x={ok:!0,message:""};function p(e){var t,s,r,n;let{quote:o}=e,i=c.bind(null,o.id),[p,h]=(0,a.useFormState)(i,x);return(0,l.jsxs)("form",{className:"mt-4 space-y-4",action:h,children:[(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-200",children:"Status"}),(0,l.jsx)("select",{id:"status",name:"status",defaultValue:function(e){let t=(null!=e?e:"").toLowerCase().trim();return"in_review"===t?"in_review":"quoted"===t?"quoted":"won"===t?"won":"lost"===t?"lost":"cancelled"===t||"canceled"===t?"cancelled":"submitted"}(null!=(t=o.status)?t:"submitted"),className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",children:u.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-slate-200",children:"Price"}),(0,l.jsx)("input",{id:"price",name:"price",type:"number",step:"0.01",inputMode:"decimal",defaultValue:null!=(s=o.price)?s:"",placeholder:"0.00",className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-200",children:"Currency"}),(0,l.jsx)("select",{id:"currency",name:"currency",defaultValue:o.currency||"USD",className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",children:m.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"targetDate",className:"block text-sm font-medium text-slate-200",children:"Target date"}),(0,l.jsx)("input",{id:"targetDate",name:"targetDate",type:"date",defaultValue:(0,d.l)(o.targetDate),className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"dfmNotes",className:"block text-sm font-medium text-slate-200",children:"DFM notes (visible to customer)"}),(0,l.jsx)("textarea",{id:"dfmNotes",name:"dfmNotes",defaultValue:null!=(r=o.dfmNotes)?r:"",rows:4,className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",placeholder:"Call out manufacturability feedback you want to share"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Customers will eventually see these notes on their quote."})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"internalNotes",className:"block text-sm font-medium text-slate-200",children:"Internal notes"}),(0,l.jsx)("textarea",{id:"internalNotes",name:"internalNotes",defaultValue:null!=(n=o.internalNotes)?n:"",rows:4,className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),!p.ok&&p.error&&(0,l.jsx)("p",{className:"text-sm text-red-400",children:p.error}),p.ok&&p.message&&(0,l.jsx)("p",{className:"text-sm text-emerald-300",children:p.message}),(0,l.jsx)("div",{className:"flex flex-col gap-3 pt-1 sm:flex-row sm:justify-end",children:(0,l.jsx)(b,{})})]})}function b(){let{pending:e}=(0,a.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:(0,r.A)(o.n4,o.m.md,"w-full sm:w-auto"),children:e?"Saving...":"Save changes"})}}},e=>{e.O(0,[619,297,441,255,358],()=>e(e.s=5077)),_N_E=e.O()}]);