(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{429:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2619,23)),Promise.resolve().then(t.bind(t,4730)),Promise.resolve().then(t.bind(t,8567)),Promise.resolve().then(t.bind(t,9867)),Promise.resolve().then(t.bind(t,826)),Promise.resolve().then(t.bind(t,2152))},826:(e,s,t)=>{"use strict";t.d(s,{SupplierBidsCard:()=>x});var l=t(5155),a=t(2115),r=t(7650),d=t(7344),n=t(8799),o=t(926);let i=(0,o.createServerReference)("700e2b845923c2db4751879b68b0dbb7fb08d7a689",o.callServer,void 0,o.findSourceMapURL,"submitSelectWinningBidAction"),c=["won","lost","cancelled"],m={ok:!0,message:""},u="Winning bid selected. Quote status updated to Won.";function x(e){let{quoteId:s,quoteStatus:t,bids:o,bidsLoaded:x,errorMessage:b}=e,[h,f]=(0,a.useState)(!1),[j,N]=(0,r.useFormState)(i.bind(null,s),m),y=(0,a.useMemo)(()=>(function(e){if(!e)return{ok:!0,message:""};if(e.ok){var s;return{ok:!0,message:null!=(s=e.message)?s:""}}return{ok:!1,error:e.error||"We couldn't update this quote. Please try again."}})(j),[j]),g=c.includes(t),v=(0,a.useMemo)(()=>o.some(e=>{var s;return"won"===(null!=(s=e.status)?s:"").toLowerCase()}),[o]),w=!h&&v,k=h&&y.ok&&!!y.message,S=y.ok?y.message:"",_=w?u:S,F=w&&!!u||k&&!!S,R=h&&!y.ok;return(0,l.jsxs)("section",{className:"mt-8 rounded-2xl border border-slate-900 bg-slate-950/40 p-4",children:[(0,l.jsxs)("div",{className:"mb-3 flex items-center justify-between gap-2",children:[(0,l.jsx)("h2",{className:"text-sm font-semibold text-slate-100",children:"Supplier bids"}),x?null:(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"We had trouble loading bids. Check logs and try again."})]}),F&&_?(0,l.jsx)("p",{className:"mb-3 rounded-lg border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-xs font-medium text-emerald-200",role:"status",children:_}):null,R?(0,l.jsx)("p",{className:"mb-3 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs font-medium text-red-200",role:"alert",children:y.error}):null,b&&x?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:b}):null,x&&0===o.length?(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"No bids have been submitted for this quote yet."}):null,x&&o.length>0?(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-left text-xs text-slate-200",children:[(0,l.jsx)("thead",{className:"border-b border-slate-800 text-[11px] uppercase tracking-wide text-slate-400",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2 pr-3",children:"Supplier"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Amount"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Lead time"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Status"}),(0,l.jsx)("th",{className:"py-2 pr-3",children:"Submitted"}),(0,l.jsx)("th",{className:"py-2 pr-3 text-right",children:"Action"})]})}),(0,l.jsx)("tbody",{children:o.map(e=>{var s;let t="number"==typeof e.amount?(0,d.v)(e.amount,e.currency,{maximumFractionDigits:2}):"—",a=e.created_at?(0,n.r)(e.created_at):"—",r=(null!=(s=e.status)?s:"submitted").toString(),o="won"===r.toLowerCase();return(0,l.jsxs)("tr",{className:"border-b border-slate-900/60 last:border-0",children:[(0,l.jsx)("td",{className:"py-2 pr-3",children:(0,l.jsx)("span",{className:"font-mono text-[11px] text-slate-400",children:e.supplier_id})}),(0,l.jsxs)("td",{className:"py-2 pr-3",children:[t,e.currency?(0,l.jsx)("span",{className:"ml-1 text-[11px] text-slate-400",children:e.currency}):null]}),(0,l.jsx)("td",{className:"py-2 pr-3",children:"number"==typeof e.lead_time_days?"".concat(e.lead_time_days," day").concat(1===e.lead_time_days?"":"s"):"—"}),(0,l.jsx)("td",{className:"py-2 pr-3",children:(0,l.jsx)("span",{className:"inline-flex rounded-full bg-slate-800/60 px-2 py-0.5 text-[11px] capitalize",children:r})}),(0,l.jsx)("td",{className:"py-2 pr-3",children:a}),(0,l.jsx)("td",{className:"py-2 pr-3",children:o?(0,l.jsx)("span",{className:"inline-flex items-center justify-end rounded-full bg-emerald-500/10 px-2 py-0.5 text-[11px] font-semibold text-emerald-200",children:"Winner"}):g||o?null:(0,l.jsxs)("form",{action:e=>(f(!0),N(e)),className:"flex justify-end",children:[(0,l.jsx)("input",{type:"hidden",name:"bidId",value:e.id}),(0,l.jsx)(p,{})]})})]},e.id)})})]})}):null]})}function p(){let{pending:e}=(0,r.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:"text-xs font-medium text-emerald-300 transition hover:text-emerald-200 disabled:cursor-not-allowed disabled:text-slate-500",children:e?"Selecting...":"Mark as winner"})}},2152:(e,s,t)=>{"use strict";t.d(s,{default:()=>p});var l=t(5155),a=t(7650),r=t(2821),d=t(8799);let n={submitted:"RFQ submitted",in_review:"In review",quoted:"Quote prepared",won:"Won",lost:"Lost",cancelled:"Cancelled"};var o=t(7275),i=t(926);let c=(0,i.createServerReference)("70afc68e9f4bd4af50612a8f7c1bde27971a3e6ea2",i.callServer,void 0,i.findSourceMapURL,"submitAdminQuoteUpdateAction"),m=["USD","EUR","GBP"],u=["submitted","in_review","quoted","won","lost","cancelled"].map(e=>({value:e,label:n[e]})),x={ok:!0,message:""};function p(e){var s,t,r,n;let{quote:o}=e,i=c.bind(null,o.id),[p,h]=(0,a.useFormState)(i,x);return(0,l.jsxs)("form",{className:"mt-4 space-y-4",action:h,children:[(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-200",children:"Status"}),(0,l.jsx)("select",{id:"status",name:"status",defaultValue:function(e){let s=(null!=e?e:"").toLowerCase().trim();return"in_review"===s?"in_review":"quoted"===s?"quoted":"won"===s?"won":"lost"===s?"lost":"cancelled"===s||"canceled"===s?"cancelled":"submitted"}(null!=(s=o.status)?s:"submitted"),className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",children:u.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-slate-200",children:"Price"}),(0,l.jsx)("input",{id:"price",name:"price",type:"number",step:"0.01",inputMode:"decimal",defaultValue:null!=(t=o.price)?t:"",placeholder:"0.00",className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-200",children:"Currency"}),(0,l.jsx)("select",{id:"currency",name:"currency",defaultValue:o.currency||"USD",className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",children:m.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"targetDate",className:"block text-sm font-medium text-slate-200",children:"Target date"}),(0,l.jsx)("input",{id:"targetDate",name:"targetDate",type:"date",defaultValue:(0,d.l)(o.targetDate),className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"dfmNotes",className:"block text-sm font-medium text-slate-200",children:"DFM notes (visible to customer)"}),(0,l.jsx)("textarea",{id:"dfmNotes",name:"dfmNotes",defaultValue:null!=(r=o.dfmNotes)?r:"",rows:4,className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400",placeholder:"Call out manufacturability feedback you want to share"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Customers will eventually see these notes on their quote."})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsx)("label",{htmlFor:"internalNotes",className:"block text-sm font-medium text-slate-200",children:"Internal notes"}),(0,l.jsx)("textarea",{id:"internalNotes",name:"internalNotes",defaultValue:null!=(n=o.internalNotes)?n:"",rows:4,className:"w-full rounded-md border border-slate-700 bg-black/40 px-3 py-2 text-sm text-slate-100 outline-none focus:border-emerald-400"})]}),!p.ok&&p.error&&(0,l.jsx)("p",{className:"text-sm text-red-400",children:p.error}),p.ok&&p.message&&(0,l.jsx)("p",{className:"text-sm text-emerald-300",children:p.message}),(0,l.jsx)("div",{className:"flex flex-col gap-3 pt-1 sm:flex-row sm:justify-end",children:(0,l.jsx)(b,{})})]})}function b(){let{pending:e}=(0,a.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:e,className:(0,r.A)(o.n4,o.m.md,"w-full sm:w-auto"),children:e?"Saving...":"Save changes"})}},4730:(e,s,t)=>{"use strict";t.d(s,{AdminQuoteMessagesCard:()=>u});var l=t(5155),a=t(2115),r=t(7650),d=t(8799),n=t(7275),o=t(926);let i=(0,o.createServerReference)("705a22a74c16ceabb9b65402e2a7ef8eca88034450",o.callServer,void 0,o.findSourceMapURL,"submitAdminQuoteMessageAction"),c={ok:!0},m={customer:"Customer",admin:"Zartman.io",supplier:"Supplier"};function u(e){let{quoteId:s,messages:t,messagesUnavailable:d=!1}=e,n=(0,a.useRef)(null),o=(0,a.useRef)(null),m=(0,a.useMemo)(()=>i.bind(null,s),[s]),[u,b]=(0,r.useFormState)(m,c);(0,a.useEffect)(()=>{var e;u.ok&&u.message&&(null==(e=n.current)||e.reset(),o.current&&(o.current.value=""))},[u.ok,u.message]);let h=t.length>0;return(0,l.jsxs)("section",{className:"space-y-4 rounded-2xl border border-slate-900 bg-slate-950/60 p-4",children:[(0,l.jsxs)("header",{className:"space-y-1",children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Customer messages"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Customer messages"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Use this thread to keep RFQ context in one place."})]})]}),d?(0,l.jsx)("p",{className:"rounded-xl border border-yellow-500/30 bg-yellow-500/5 px-3 py-2 text-sm text-yellow-100",children:"Messages are temporarily unavailable. Refresh to try again."}):null,(0,l.jsx)(x,{messages:t,hasMessages:h}),(0,l.jsxs)("div",{className:"space-y-3 border-t border-slate-900/60 pt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-slate-100",children:"Reply"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Visible to the requesting customer and Zartman admins."})]}),(0,l.jsx)(p,{ref:n,textareaRef:o,onSubmit:b,state:u,disabled:d})]})]})}function x(e){let{messages:s,hasMessages:t}=e;return t?(0,l.jsx)("ol",{className:"space-y-3",children:s.map(e=>{var s,t;return(0,l.jsxs)("li",{className:"rounded-2xl border border-slate-900/70 bg-slate-950/40 px-4 py-3",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-slate-400",children:[(0,l.jsx)("span",{className:"font-semibold text-slate-100",children:null!=(s=m[e.author_type])?s:m.admin}),(0,l.jsx)("span",{children:null!=(t=(0,d.r)(e.created_at,{includeTime:!0}))?t:""})]}),(0,l.jsx)("p",{className:"mt-2 whitespace-pre-wrap text-sm leading-relaxed text-slate-100",children:e.body})]},e.id)})}):(0,l.jsx)("p",{className:"rounded-2xl border border-dashed border-slate-800/70 bg-black/30 px-4 py-4 text-sm text-slate-400",children:"No messages yet. Reply here to keep the customer looped in."})}let p=(0,a.forwardRef)((e,s)=>{var t;let{onSubmit:a,state:r,disabled:d=!1,textareaRef:n}=e,o=null==(t=r.fieldErrors)?void 0:t.body,i=r.ok&&!!r.message;return(0,l.jsxs)("form",{ref:s,action:a,className:"space-y-3",children:[i?(0,l.jsx)("p",{className:"rounded-xl border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-100",children:r.message}):null,!r.ok&&r.error?(0,l.jsx)("p",{className:"rounded-xl border border-red-500/30 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:r.error}):null,(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{htmlFor:"admin-quote-message-body",className:"text-sm font-medium text-slate-200",children:"Message"}),(0,l.jsx)("textarea",{id:"admin-quote-message-body",name:"body",ref:n,rows:4,maxLength:2e3,disabled:d,className:"w-full rounded-lg border border-slate-800 bg-black/30 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60",placeholder:"Share an update or ask a follow-up question..."}),o?(0,l.jsx)("p",{className:"text-sm text-red-300",role:"alert",children:o}):null]}),(0,l.jsx)(b,{disabled:d})]})});function b(e){let{disabled:s}=e,{pending:t}=(0,r.useFormStatus)();return(0,l.jsx)("button",{type:"submit",disabled:t||s,className:"".concat(n.n4," ").concat(n.m.md," w-full sm:w-auto"),children:t?"Sending...":"Reply"})}p.displayName="AdminQuoteMessageComposerForm"}},e=>{e.O(0,[619,297,441,255,358],()=>e(e.s=429)),_N_E=e.O()}]);